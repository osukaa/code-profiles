/*
 * wallaby-vscode - v1.0.184
 * http://wallabyjs.com
 * Copyright (c) 2014-2020 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of wallaby-vscode and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */

!function s(r,l,c){process.env.WALLABY_PRODUCTION=!0;var u="function"==typeof require&&require;module.exports=function a(n,e){if(!l[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var o=l[n]={exports:{}};r[n][0].call(o.exports,function(e){var t=r[n][1][e];return a(t||e)},o,o.exports,s,r,l,c)}return l[n].exports}(c[0])}({1:[function(u,e,t){"use strict";var a=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var d=u("fs"),h=u("path"),p=u("os"),g=u("vscode"),n=u("./lib/compositeDisposable"),f=g.window,i=g.workspace,r=/^darwin/.test(process.platform),l=u("./package.json").version,y=void 0,v=void 0,m="https",_=void 0,c=function(){function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c)}return a(c,[{key:"activate",value:function(o){var s=this;s._disposables=new n,s._disposables.add(function(){delete s._failedUpdateCount,clearTimeout(s._updateChecker)}),setImmediate(function(){y=u("q"),v=u("lockfile");try{g.workspace.getConfiguration()&&(g.workspace.getConfiguration().get("wallaby.useHttpForDownload",!1)&&(m="http"),g.workspace.getConfiguration().get("wallaby.strictSSL",!0)||(_=!1))}catch(e){}s._baseUrl=m+"://update.wallabyjs.com/",s._versionFile=h.join(__dirname,"wallaby.json"),s._updateLockFile=h.join(__dirname,"update.lock"),s._updateLockOpts={stale:6e5},s._corePackage=h.join(__dirname,"..","wallaby","package.json"),s._coreFolder=h.dirname(s._corePackage),s._lkp=h.join(p.homedir(),".wallaby","key.lic"),s._oldlkp=h.join(d.realpathSync(o.extensionPath),"..",".wlck"),!d.existsSync(s._lkp)&&d.existsSync(s._oldlkp)&&(s._lkp=s._oldlkp),(c._isDebugMode()||c._noAutomaticInstallMode())&&(c._download=function(){throw new Error("Can not delete/download/extract in this mode")}),s._setupStatusIndicator(),s._updateIfRequired(!0,void 0,c._expiryDate(s._lkp),!1).then(function(e){var t=e[1],a=u("../wallaby/client"),n={context:o,coreClient:a,statusBar:s._statusBar,onFirstStart:function(){clearTimeout(s._updateChecker),s._updateChecker=setTimeout(function(){return s._performUpdate(n,!1)},6e5)},licenseChanged:function(){clearTimeout(s._updateChecker),s._performUpdate(n,!1)},updateAvailable:function(){},forceCoreUpdate:function(){c._isDebugMode()||c._noAutomaticInstallMode()?f.showErrorMessage("Force core update is not available when 'wallaby.noAutomaticInstall' is 'true'."):(f.showInformationMessage("Downloading Wallaby.js core. Depending on the speed of your internet connection this may take a few moments."),s._performUpdate(n,!0))},debug:c._isDebugMode(),licensed:!1,isMac:r,firstInstall:t,deactivate:function(){return s.deactivate()},version:c._getVersion()},i=u("./lib/controller");s._controller=new i(n),s._controller.activate(),s._disposables.add(function(){return s._controller.deactivate()}),console.log("[Wallaby Console] VS Code extension v"+l),console.log("[Wallaby Console] Core v"+c._requireNoCache(s._corePackage).version)}).fail(function(e){return c._notifyError(e.message)}).finally(function(){return s._hideStatusIndicator()})})}},{key:"_performUpdate",value:function(a,e){var n=this;return n._updateIfRequired(!1,a.licensed,c._expiryDate(n._lkp),e).then(function(e){var t=e[0];t&&(global._wallabyNewCore=t),t&&a.updateAvailable(function(t){t=t||function(){};try{var e=[],a=global._wallabyNewCore;delete global._wallabyNewCore,a&&d.existsSync(a)&&(n._suppressUpdateNotifications||f.showInformationMessage("Updating wallaby.js core. It may take a few seconds, you will be notified once the update is finished."),e.push(c._extract(a,n._coreFolder))),y.all(e).then(function(){global._wallabyHasJustUpdated=!0,delete n._failedUpdateCount,n._suppressUpdateNotifications||f.showInformationMessage("Wallaby.js core has been successfully updated to v"+c._requireNoCache(n._corePackage).version+".")}).fail(function(e){return c._notifyError(e.message)}).then(function(){return t()})}catch(e){t()}})}).fail(function(e){n._failedUpdateCount=n._failedUpdateCount?n._failedUpdateCount+1:1,console.error(e)}).finally(function(){n._failedUpdateCount&&3<n._failedUpdateCount||(n._updateChecker=setTimeout(function(){return n._performUpdate(a)},6e5))})}},{key:"_updateIfRequired",value:function(o,t,a,n){var s=this,i=global._wallabyHasJustUpdated,r=s._baseUrl;delete global._wallabyHasJustUpdated;var l=function(e){return c._download({name:"version",from:e+"wallaby.json?licensed="+(t?"true":"false")+(a?"&expiry="+a.replace(/\//g,"-"):""),to:s._versionFile})};return y.all([i&&!n?y.when({}):c._stat(s._corePackage)]).then(function(e){var t=n?void 0:e[0],a=h.join(p.homedir(),".wallaby","downloads","wallaby.zip");if(!t&&!n&&d.existsSync(a))try{new(u("adm-zip-mit"))(a).extractAllTo(s._coreFolder,!0),t=d.statSync(s._corePackage)}catch(e){console.log(e)}return y.all([t,c._isDebugMode()||c._noAutomaticInstallMode()||i||o&&t?y.when({core:t&&c._requireNoCache(s._corePackage).version||"unknown"}):(s._statusUpdater("Downloading wallaby.js version file"),l(s._baseUrl).fail(function(){return r=m+"://s3.amazonaws.com/wallaby-downloads/",l("http://update.wallabyjs.com/")}).then(function(){return s._version()}))])}).then(function(e){var t=e[0],a=e[1],n=[y.when(!1)];if(v.checkSync(s._updateLockFile,s._updateLockOpts))return y.all(n);var i=!0;if(c._noAutomaticInstallMode()&&!t)throw new Error("With wallaby.noAutomaticInstall option set, you need to manually install wallaby core and dependencies when the extension is installed/updated.");return t&&c._requireNoCache(s._corePackage).version===a.core||(n[0]=c._download({name:"core",from:r+"wallaby-v"+a.core+".zip",to:s._coreFolder,unzip:o}).fail(function(){return c._download({name:"core",from:m+"://s3.amazonaws.com/wallaby-downloads/wallaby-v"+a.core+".zip",to:s._coreFolder,unzip:o})}),s._statusUpdater("Downloading and extracting wallaby.js core"),i=!1),i||v.lockSync(s._updateLockFile,s._updateLockOpts),o&&!i&&(s._suppressUpdateNotifications||f.showInformationMessage("Updating wallaby.js core. It may take a few seconds, you will be notified once the update is finished.")),y.all(n).then(function(e){return i||v.unlockSync(s._updateLockFile),o&&!i&&(s._suppressUpdateNotifications||f.showInformationMessage("Wallaby.js core v"+a.core+" has been successfully installed.")),y.when(e)})})}},{key:"_version",value:function(){var e=c._requireNoCache(this._versionFile),t=void 0;return e.latestServer.forEach(function(e){e.substring(0,e.lastIndexOf("."))===l.substring(0,e.lastIndexOf("."))&&(t=e)}),{core:t}}},{key:"_setupStatusIndicator",value:function(){var a=this;a._statusBar=f.createStatusBarItem(g.StatusBarAlignment.Right,Number.NEGATIVE_INFINITY),a._statusBar.show();var e=a._statusBar.hide.bind(a._statusBar),t=a._statusBar.dispose.bind(a._statusBar);a._statusBar.hide=function(){a._statusBar.stopProgress(),e()},a._statusBar.dispose=function(){a._statusBar.stopProgress(),t()},a._statusBar.displayProgress=function(){var e=0,t=["[=--------]","[-=-------]","[--=------]","[---=-----]","[----=----]","[-----=---]","[------=--]","[-------=-]","[--------=]","[-------=-]","[------=--]","[-----=---]","[----=----]","[---=-----]","[--=------]","[-=-------]"];clearInterval(a._statusBar._progress),a._statusBar._progress=setInterval(function(){a._statusBar.setMainText(t[e=++e%t.length]+"   "),a._statusBar._doUpdateText()},150)},a._statusBar.setMainText=function(e){a._statusBar._mainText=e},a._statusBar.setExtensionText=function(e){a._statusBar._extensionText=e},a._statusBar.updateText=function(){return a._statusBar._doUpdateText()},a._statusBar._doUpdateText=function(){a._statusBar.text=(a._statusBar._extensionText||"")+"   "+(a._statusBar._mainText||"")},a._statusBar.stopProgress=function(){clearInterval(a._statusBar._progress),delete a._statusBar._progress},a._statusBar.displayProgress(),a._statusUpdater=function(e){a._statusBar.tooltip=e},a._disposables.add(function(){a._removeStatusIndicator()}),a._statusBar.hide()}},{key:"_hideStatusIndicator",value:function(){this._statusBar&&(this._statusBar.text="",this._statusBar.tooltip="",this._statusBar.hide()),this._statusUpdater=function(){}}},{key:"_removeStatusIndicator",value:function(){this._statusBar&&this._statusBar.dispose(),this._statusUpdater=function(){}}},{key:"deactivate",value:function(){this._disposed||(this._disposables.dispose(),this._disposed=!0)}},{key:"suppressUpdateNotifications",value:function(){this._suppressUpdateNotifications=!0}}],[{key:"_isDebugMode",value:function(){return i.getConfiguration()&&i.getConfiguration().get("wallaby.debug",!1)}},{key:"_noAutomaticInstallMode",value:function(){return i.getConfiguration()&&i.getConfiguration().get("wallaby.noAutomaticInstall",!1)}},{key:"_requireNoCache",value:function(e){return delete originalRequire.cache[originalRequire.resolve(e)],originalRequire(e)}},{key:"_stat",value:function(e){return y.nfcall(d.stat,e).fail(function(){return!1})}},{key:"_remove",value:function(t,a,n){return(a?y.nfcall(u("fs-extra").remove,t):y.nfcall(d.unlink,t)).fail(function(e){if(n)throw e;return c._remove(t,a,!0)})}},{key:"_download",value:function(o){return y.promise(function(e,t){var a=u("request"),n=h.extname(o.from),i=".zip"===n?h.join(p.homedir(),".wallaby","downloads",h.basename(o.to)+n):o.to;".zip"===n&&(d.existsSync(h.join(p.homedir(),".wallaby"))||d.mkdirSync(h.join(p.homedir(),".wallaby")),d.existsSync(h.join(p.homedir(),".wallaby","downloads"))||d.mkdirSync(h.join(p.homedir(),".wallaby","downloads")));try{a({url:o.from,headers:{"User-Agent":"VS Code "+g.version},strictSSL:_}).on("response",function(e){e&&500<=e.statusCode&&t(new Error("Error while downloading wallaby.js "+o.name+" status code: "+e.statusCode))}).on("error",function(e){return t(new Error("Error while downloading wallaby.js "+o.name+" file: "+e.message))}).pipe(d.createWriteStream(i)).on("error",function(e){return t(new Error("Error while saving wallaby.js "+o.name+" file: "+e.message))}).on("close",function(){o.unzip?c._extract(i,o.to).then(function(){return e(i)}).fail(function(e){return t(new Error("Error while unzipping wallaby.js "+o.name+" file: "+e.message))}):e(i)})}catch(e){t(e)}})}},{key:"_extract",value:function(e,n){return c._remove(n,!0).then(function(){return y.promise(function(t,a){try{new(u("adm-zip-mit"))(e).extractAllToAsync(n,!0,function(e){e?a(e):t(!0)})}catch(e){a(e)}})})}},{key:"_notifyError",value:function(e){f.showErrorMessage(e)}},{key:"_expiryDate",value:function(e){try{var t=u("fs").readFileSync(e).toString();if(t){var a=t.split(":");2===a.length&&(t=(n=a[1])&&n.replace(/^\s+|\s+$/gm,""))}return Buffer.from(t,"base64").toString().split("\n")[2]}catch(e){}var n}},{key:"_getVersion",value:function(){var e=1,t=0;try{var a=g.version.split(".");e=parseInt(a[0],10),t=parseInt(a[1],10)}catch(e){}return{major:e,minor:t}}}]),c}();t.activate=function(n){var e=new c;n.subscriptions.push({dispose:function(){return e.deactivate()}});var t,a,i,o=c._getVersion();o.major<=1&&o.minor<18&&(t=process.exit,a=process.exit=function(){(function(){e.deactivate(),t.apply(process,arguments)}).apply(null,arguments)},process.on("SIGINT",function(){a.apply(null,arguments)}),process.on("SIGTERM",function(){a.apply(null,arguments)}),process.on("exit",function(){a.apply(null,arguments)}));try{if(l=g.workspace.getConfiguration()){var s=l.get("http.proxy","");s&&(process.env.http_proxy=s);var r=l.get("https.proxy","");r&&(process.env.https_proxy=r),l.get("wallaby.showUpdateNotifications",!0)||e.suppressUpdateNotifications()}}catch(e){}try{var l;(l=g.workspace.getConfiguration())&&(i=l.get("wallaby.colors",{}))&&Object.keys(i).forEach(function(t){try{if(!t)return;var e=n.asAbsolutePath(h.join("images",t+".svg"));if(!d.existsSync(e))return;var a=('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100%" height="100%">'+p.EOL+"  <g>"+p.EOL+'    <rect x="22%" y="22%" width="56%" height="56%" rx="12%" ry="12%" style="fill:#62b455;fill-opacity:1;" />'+p.EOL+"  </g>"+p.EOL+"</svg>").replace(/fill:#.[^;]*/,"fill:"+i[t]);a!==d.readFileSync(e).toString()&&d.writeFileSync(e,a)}catch(e){console.error("Failed to set icon "+t+" type to "+i[t]+". "+e.message)}})}catch(e){}e.activate(n)}},{"./lib/compositeDisposable":3,"./lib/controller":4,"./package.json":10,"adm-zip-mit":void 0,fs:void 0,"fs-extra":void 0,lockfile:void 0,os:void 0,path:void 0,q:void 0,request:void 0,vscode:void 0}],2:[function(a,e,t){"use strict";var n=a("vscode"),i=a("path");t.activate=function(e){var t=n.workspace.getConfiguration()&&n.workspace.getConfiguration().get("wallaby.debug",!1);return t&&(global.originalRequire=a),t||"dist"===i.basename(__dirname)?a("./extension").activate(e):(global.originalRequire=a)("./dist/index").activate(e)}},{"./extension":1,path:void 0,vscode:void 0}],3:[function(e,t,a){"use strict";var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._disposables=[]}return n(e,[{key:"add",value:function(e){e.dispose?this._disposables.push(e):this._disposables.push({dispose:e})}},{key:"dispose",value:function(){this._disposables.forEach(function(e){return e.dispose()})}}]),e}();t.exports=i},{}],4:[function(o,e,t){"use strict";var d=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,i=!1,o=void 0;try{for(var s,r=e[Symbol.iterator]();!(n=(s=r.next()).done)&&(a.push(s.value),!t||a.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},a=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function c(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}var y=o("path"),i=o("crypto"),v=o("fs-extra"),m=o("os"),b=o("vscode"),h=o("./compositeDisposable"),p=o("./screenshotContentProvider"),g=o("./testsOutputBuilder"),f=o("./valueExplorer"),w=o("./traceExplorer"),k=o("./testFileCoverageExplorer"),T=b.workspace,x=b.window,S=1,C={"wallaby.start":{visible:!0},"wallaby.stop":{visible:!0},"wallaby.startExclusively":{visible:!0},"wallaby.showCommandPalette":{visible:!1},"wallaby.showLastScreenshot":{visible:!0},"wallaby.showLicense":{visible:!0},"wallaby.runProjectTests":{visible:!0},"wallaby.runLineTests":{visible:!0},"wallaby.runFileTests":{visible:!0},"wallaby.updateProjectSnapshots":{visible:!0},"wallaby.updateFileSnapshots":{visible:!0},"wallaby.updateTestSnapshots":{visible:!0},"wallaby.jumpToFailingTest":{visible:!0},"wallaby.jumpToErrorSource":{visible:!0},"wallaby.toggleUncovered":{visible:!0},"wallaby.toggleTestFilter":{visible:!0},"wallaby.showLineTests":{visible:!0},"wallaby.showLineTestsFromMenu":{visible:!1},"wallaby.selectConfigFile":{visible:!0},"wallaby.showFailingTests":{visible:!0},"wallaby.showSideBySideDiff":{visible:!0},"wallaby.openWallabyApp":{visible:!0},"wallaby.showValue":{visible:!0},"wallaby.copyValue":{visible:!0},"wallaby.copyExpressionPath":{visible:!1},"wallaby.copyExpressionData":{visible:!1},"wallaby.goToExpressionSource":{visible:!1},"wallaby.copyDiagnosticsReportToClipboard":{visible:!0},"wallaby.runModeOnSave":{visible:!0},"wallaby.runModeImmediate":{visible:!0},"wallaby.runModeToggle":{visible:!0},"wallaby.forceCoreUpdate":{visible:!0},"wallaby.resetTestFilter":{visible:!1},"wallaby.resetUncovered":{visible:!1},"wallaby.playTraceNextStep":{visible:!1},"wallaby.playTracePrevStep":{visible:!1},"wallaby.playTraceNextStepOut":{visible:!1},"wallaby.playTracePrevStepOut":{visible:!1},"wallaby.playTraceNextStepOver":{visible:!1},"wallaby.playTracePrevStepOver":{visible:!1},"wallaby.playTraceForwardToSelection":{visible:!1},"wallaby.playTraceBackwardToSelection":{visible:!1},"wallaby.openCallStackFrame":{visible:!1},"wallaby.revealTraceStep":{visible:!1},"wallaby.stopTraceNavigation":{visible:!1},"wallaby.statusBarCommand":{visible:!1},"wallaby.debugTest":{visible:!0},"wallaby.jumpToTest":{visible:!0},"wallaby.openFile":{visible:!1},"wallaby.addToExclusiveTestRun":{visible:!0},"wallaby.addToExclusiveTestRunFromMenu":{visible:!1},"wallaby.startExclusivelyFromMenu":{visible:!1}},s=function(e){function u(e){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),function(e,t,a){for(var n=!0;n;){var i=e,o=t,s=a;n=!1,null===i&&(i=Function.prototype);var r=Object.getOwnPropertyDescriptor(i,o);if(void 0!==r){if("value"in r)return r.value;var l=r.get;if(void 0===l)return;return l.call(s)}var c=Object.getPrototypeOf(i);if(null===c)return;e=c,t=o,a=s,n=!0,r=c=void 0}}(Object.getPrototypeOf(u.prototype),"constructor",this).call(this);var s=this;this._state=e,this._context=e.context,this._statusBar=e.statusBar,this._Session=e.coreClient.Session,this._utils=e.coreClient.utils,this._isMac=e.isMac,this._firstInstall=e.firstInstall,this._deactivator=e.deactivate,this._lineAndColumnLinks=!1,this._activeLicenseSession=null,e.updateAvailable=_.bind(this._updateAvailable,this),this._disposables=new h,_.each(C,function(e,t){return s._disposables.add(b.commands.registerCommand(t,function(e){return s[t.substring(8,t.length)](e)}))}),this._activeTraceFrameWithNowhereToGoDecorationType=x.createTextEditorDecorationType({rangeBehavior:1,borderStyle:"solid",borderRadius:"2px",borderWidth:"1px",dark:{backgroundColor:"rgba(255, 0, 0, 0.2)",borderColor:"rgba(255, 0, 0, 0.2)"},light:{backgroundColor:"rgba(255, 0, 52, 0.35)",borderColor:"rgba(255, 0, 52, 0.35)"}}),this._activeTraceFrameDecorationType=x.createTextEditorDecorationType({rangeBehavior:1,borderStyle:"solid",borderRadius:"2px",borderWidth:"1px",dark:{backgroundColor:"rgba(255, 255, 0, 0.2)",borderColor:"rgba(255, 255, 0, 0.2)"},light:{backgroundColor:"rgba(255, 255, 102, 0.45)",borderColor:"rgba(255, 255, 102, 0.45)"}});var t={rangeBehavior:1,borderStyle:"solid",borderRadius:"2px",borderWidth:"1px",dark:{backgroundColor:"rgba(122, 189, 122, 0.3)",borderColor:"rgba(122, 189, 122, 0.3)"},light:{backgroundColor:"rgba(206, 231, 206, 0.45)",borderColor:"rgba(206, 231, 206, 0.45)"}};this._activeTraceCallStackFrameDecorationType=x.createTextEditorDecorationType(t),this._activeValueCallStackFrameDecorationType=x.createTextEditorDecorationType(t),this._coverageDecorationTypes={0:this._createCoverageDecorationType("errorSource"),1:this._createCoverageDecorationType("notCovered"),2:this._createCoverageDecorationType("covered"),3:this._createCoverageDecorationType("partiallyCovered"),4:this._createCoverageDecorationType("errorSource",!0),5:this._createCoverageDecorationType("errorPath")},this._outputDocumentSelector={language:"wallaby-output"},this._setupVersionSpecificComponents(e.version),this._uncoveredRegionDecorationType=x.createTextEditorDecorationType({backgroundColor:"#d2a032",color:"#ffffff"}),b.languages.setTextDocumentLanguage&&s._disposables.add(T.onDidOpenTextDocument(function(a){var n;a&&a.uri&&"output"===a.uri.scheme&&(n=function(e,t){var a=e.lineAt(0);if(a&&a.text&&a.text.length)return~a.text.indexOf("​")||~a.text.indexOf(" ")||~a.text.indexOf(" ");t&&t()})(a,function(){var t=T.onDidChangeTextDocument(function(e){e.document===a&&(t.dispose(),n(e.document)&&b.languages.setTextDocumentLanguage(a,"wallaby-output"))})})&&b.languages.setTextDocumentLanguage(a,"wallaby-output")})),this._testsOutputChannel=x.createOutputChannel("Wallaby.js Tests"),this._consoleOutputChannel=x.createOutputChannel("Wallaby.js Console"),this._testsOutputChannel.append("​"),this._consoleOutputChannel.append("​");var a=_.bind(s._absoluteFilePath,s);this._failingTestsOutput=new g(this._testsOutputChannel,a,e.coreClient.dmp,this._disposables,this._lineAndColumnLinks,!0,this._outputDocumentSelector,this._sideBySideDiffSupported,_.bind(this._getWallabyAppUrl,this)),this._lineTestsOutput=new g(this._testsOutputChannel,a,e.coreClient.dmp,this._disposables,this._lineAndColumnLinks,void 0,this._outputDocumentSelector,this._sideBySideDiffSupported,_.bind(this._getWallabyAppUrl,this)),b.workspace.registerTextDocumentContentProvider&&(s._screenshotProvider=new p(function(){return y.join(s._session.projectCachePath,"instrumented","screen.png")}),s._disposables.add(b.workspace.registerTextDocumentContentProvider("wallaby-screenshot",s._screenshotProvider)),s._disposables.add(b.workspace.registerTextDocumentContentProvider("wallaby-diff",{provideTextDocumentContent:function(e){return Buffer.from(e.query.toString(),"base64").toString()}})));var r=new b.CodeAction("Debug test",b.CodeActionKind.Empty),l=new b.CodeAction("Add test to filter",b.CodeActionKind.Empty),c=new b.CodeAction("Remove test from filter",b.CodeActionKind.Empty);r.command={command:"wallaby.debugTest",title:""},l.command=c.command={command:"wallaby.toggleTestFilter",title:""};var n=["javascript","javascriptreact","typescript","typescriptreact","coffeescript","vue"];s._disposables.add(b.languages.registerCodeActionsProvider(n,{provideCodeActions:function(e,t){if(s._session){var a=s._getDocumentFilePath(e),n=s._session.openedDocuments[a];if(n&&(!n.changeTs||n.changeTs<n.updateTs)){var i=n.testDeclarations[t.end.line];if(i&&!o._traceExplorer.traceBeingNavigated())return[r,i.filtered?c:l]}}return[]}},{providedCodeActionKinds:[b.CodeActionKind.Empty]})),s._disposables.add(b.languages.registerHoverProvider(n,{provideHover:function(e,t){if(s._stats&&s._stats.errors)return new Promise(function(a){if(!s._session)return a();var n=t.line+1;s._session.requestError({file:s._getDocumentFilePath(e),line:n,type:"errorSource"},function(e){if(!e||!e.error||!e.error.expected&&!e.error.actual)return a();var t=s._failingTestsOutput.createDiffMarkdown(e.error.expected,e.error.actual,e.error.snapshot,n);return b.MarkdownString&&((t=new b.MarkdownString(t)).isTrusted=!0),a(new b.Hover(t))})})}})),this._valueExplorer=new f(this._context,function(){return"https://wallabyjs.com/docs/intro/"+(o._traceExplorer.traceBeingNavigated()?"time-travel-debugger.html#inspecting-runtime-values":"value-explorer.html")}),this._traceExplorer=new w(this._context),this._testFileCoverageExplorer=new k(this._context)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,EventEmitter),a(u,[{key:"_setupVersionSpecificComponents",value:function(e){var t=e.major,a=e.minor;1<=t&&2<=a&&b.workspace.registerTextDocumentContentProvider&&(this._sideBySideDiffSupported=!0),1<=t&&3<=a&&(this._hideAfterContentDecorationType=x.createTextEditorDecorationType({isWholeLine:!0,after:{margin:"0 0 0 10000px"}})),1<=t&&5<=a&&(this._lineAndColumnLinks=!0),1<=t&&10<=a&&(u._escapeInlineMessage=function(e){return e}),1<=t&&11<=a&&(this._outputDocumentSelector.scheme="*"),1<=t&&16<=a&&(this._multiFolderWorkspaces=!0)}},{key:"_createCoverageDecorationType",value:function(e,t){return x.createTextEditorDecorationType({isWholeLine:!0,rangeBehavior:1,gutterIconPath:this._context.asAbsolutePath(y.join("images",e+".svg")).split("\\").join("/"),light:{after:{color:"errorSource"===e&&t?"#c80000":"#0000ff"}},dark:{after:{color:"errorSource"===e&&t?"#fe536a":"rgba(86, 156, 214, 1)"}}})}},{key:"activate",value:function(){var n=this,i=this;this._diagnosticEntries={},this._diagnosticCollection=b.languages.createDiagnosticCollection("wallaby"),this._originalOnceDocumentStopsChanging=this._onceDocumentStopsChanging,this._onceDocumentStopsChanging=_.debounce(_.bind(this._originalOnceDocumentStopsChanging,this),100),u._outputTestResults=_.debounce(_.bind(u._outputTestResults,this),100),this._processOpenedEditors=_.debounce(_.bind(this._processOpenedEditors,this),100),i._statusBar.updateText=_.debounce(_.bind(i._statusBar.updateText,i._statusBar),200),this._executeCommand=_.bind(this._execute,this),this._packagePath=v.realpathSync(this._context.extensionPath),this._packageMetadata=o(y.join(this._packagePath,"package.json")),this._wallabyFolder=y.join(m.homedir(),".wallaby"),this._lkp=y.join(this._wallabyFolder,"key.lic"),this._ol=y.join(this._wallabyFolder,".ol");try{v.existsSync(this._wallabyFolder)||v.mkdirSync(this._wallabyFolder);var e=y.join(this._packagePath,"..",".wlck");if(!v.existsSync(this._lkp)&&v.existsSync(e)){var t=v.readFileSync(e).toString();v.writeFileSync(i._lkp,t),v.unlinkSync(e)}}catch(e){}i._commands=_.reduce(this._packageMetadata.contributes.commands,function(e,t){var a=C[t.command];return a&&a.visible&&(e[t.title]=t),e},{}),i._keyBindings=_.reduce(this._packageMetadata.contributes.keybindings,function(e,t){return e[t.command]=t,e},{}),i._firstInstall&&x.showInformationMessage("Start with displaying all wallaby.js commands using "+i._formatShortcut(i._keyBindings["wallaby.showCommandPalette"])+" shortcut."),this._statusBar.command="wallaby.statusBarCommand",this._setActiveProjectRootAndConfig(),this._disposables.add(function(){if(i.stop(!0),i._statusBar&&i._statusBar.hide(),n._activeLicenseSession)try{n._activeLicenseSession.stop(),n._activeLicenseSession=null}catch(e){}i._testsOutputChannel.dispose(),i._consoleOutputChannel.dispose(),_.each(i._coverageDecorationTypes,function(e){return e.dispose()}),i._uncoveredRegionDecorationType.dispose(),i._activeTraceFrameDecorationType.dispose(),i._activeTraceCallStackFrameDecorationType.dispose(),i._activeValueCallStackFrameDecorationType.dispose(),i._activeTraceFrameWithNowhereToGoDecorationType.dispose()}),this.on("stopped",function(){i._setContext("wallaby.started",!1),i._setContext("wallaby.reportedAtLeastOnceLogValue",!1),i._setContext("wallaby.testFilterToggled",!1),i._setContext("wallaby.uncoveredToggled",!1),i._testFilterToggled=!1,i._removeStatus()}),this.on("projectConfigured",function(e){_.isNumber(e.editDelay)&&(i._onceDocumentStopsChanging=_.debounce(_.bind(i._originalOnceDocumentStopsChanging,i),e.editDelay))}),this.on("busy",function(){clearTimeout(i._statusUpdateTimeout),i._statusUpdateTimeout=setTimeout(function(){return i._updateStatus("progress")},300)}),this.on("notification",function(e){var t=[];if(~e.text.indexOf("extended-trial-license-link")&&t.push({title:"Request License",command:"_requestTrialLicense"}),!~e.text.indexOf("expire")||"warning"!==e.type||!n._suppressExpirationNotifications){~e.text.indexOf("activate-link")&&t.push({title:"Enter License",command:"wallaby.showLicense"}),~e.text.indexOf("continue-trial-link")&&t.push({title:"Continue Trial",command:"_continueTrial"}),~e.text.indexOf("purchase")&&t.push({title:"Purchase",command:"_openPurchasePage"}),~e.text.indexOf("PhantomJs docs")&&t.push({title:"View Documentation",command:"_openPhantomJsDocs"}),~e.text.indexOf("auto-config-info-link")&&t.push({title:"View Documentation",command:"_openAutoConfigDocs"}),e.text=e.text.replace(/<br\/><br\/>/g," ").replace(/<br\/>/g," ").replace(/<[^>]*>/g,"");var a=[e.text].concat(t);x["show"+e.type.charAt(0).toUpperCase()+e.type.substr(1)+("info"===e.type?"rmation":"")+"Message"].apply(x,a).then(i._executeCommand),0===e.text.indexOf("Can not start node.js process")&&x.showInformationMessage('You may use the "wallaby.node" setting to configure the location of node.')}}),this.on("stats",function(e){e&&(i._stats=e,_.isObject(e)&&n._traceExplorer.update(e.trace),u._outputTestResults(i._failingTestsOutput,e,!1,i._testFilterToggled),n._updateDiagnosticsCollection(e),n._runScheduledActionOnResultsAvailable()),i._updateStatus()}),this.on("activeTestFileCoverageChanged",function(e){n._testFileCoverageExplorer.update(e)}),this.on("filesToTrack",function(e,t){var a=n;_.reduce(t,function(e,t){return e[t]||(e[t]={changes:[],path:t}),e},e.filesToTrack),a._processOpenedEditors(e)}),this.on("live",function(e){i._setContext("wallaby.started",!0),i._observeDocuments(e)}),this.on("documentUpdates",function(e,t){i._updateDocuments(e,t),i._displayStatusForActiveEditor(e),i._screenshotProvider&&i._screenshotProvider.update()}),this.on("fileMessages",function(e){i._setContext("wallaby.reportedAtLeastOnceLogValue",!0),n._valueExplorer.update(e)}),this._multiFolderWorkspaces&&T.onDidChangeWorkspaceFolders&&this._disposables.add(T.onDidChangeWorkspaceFolders(function(){var e=n._activeConfig;n._setActiveProjectRootAndConfig(n._activeConfig),e!==n._activeConfig&&n.stop(!0)})),this._projectRunningState()&&b.workspace.getConfiguration().get("wallaby.startAutomatically",!0)&&this.start()}},{key:"_projectRunningState",value:function(){return this._activeProjectRoot()&&this._context.workspaceState.get("wallaby:runningstate:"+u._hash(this._activeProjectRoot()))}},{key:"_setProjectRunningState",value:function(e){e?this._context.workspaceState.update("wallaby:runningstate:"+u._hash(this._activeProjectRoot()),1):this._context.workspaceState.update("wallaby:runningstate:"+u._hash(this._activeProjectRoot()),void 0)}},{key:"_configFile",value:function(e){this._setActiveProjectRootAndConfig(e)}},{key:"_findProject",value:function(t){var a,e=this;if(t){if(this._multiFolderWorkspaces&&T.workspaceFolders){var n=_.find(T.workspaceFolders,function(e){return~t.indexOf(e.uri.fsPath+y.sep)});if(n)return n.uri.fsPath}else if(T.rootPath&&~t.indexOf(T.rootPath))return T.rootPath}else{if(!this._multiFolderWorkspaces||!T.workspaceFolders)return T.rootPath;var i=(a=e._context.workspaceState.get("wallaby:activeProjectRoot"))&&_.find(T.workspaceFolders,function(e){return a===e.uri.fsPath})?{v:a}:T.workspaceFolders.length?{v:T.workspaceFolders[0].uri.fsPath}:void 0;if("object"==typeof i)return i.v}}},{key:"_setActiveProjectRootAndConfig",value:function(e,t){!e||v.existsSync(e)||e.endsWith("auto.detect")||(e=void 0),this._activeProject=this._findProject(e)||void 0,e&&!this._activeProject&&(e=void 0,this._activeProject=this._findProject()),this._context.workspaceState.update("wallaby:activeProjectRoot",this._activeProject),this._activeProject?(e?this._activeConfig=e:(this._activeConfig=this._context.workspaceState.get("wallaby:configPath:"+u._hash(this._activeProjectRoot())),!this._activeConfig||v.existsSync(this._activeConfig)||this._activeConfig.endsWith("auto.detect")||delete this._activeConfig,!this._activeConfig&&t&&(this._activeConfig=this._configByConvention())),this._context.workspaceState.update("wallaby:configPath:"+u._hash(this._activeProject),this._activeConfig),this._activeConfigFolder=this._activeConfig?y.dirname(this._activeConfig):void 0):(this._activeConfig=void 0,this._activeConfigFolder=void 0)}},{key:"_activeProjectRoot",value:function(){return this._activeProject}},{key:"_configPath",value:function(){return this._activeConfig}},{key:"_configFolderPath",value:function(){return this._activeConfigFolder}},{key:"deactivate",value:function(){this._disposed||(this._disposables.dispose(),this._disposed=!0)}},{key:"_forceDeactivate",value:function(){this._deactivator(),_.each(C,function(e,t){return b.commands.registerCommand(t,function(){return x.showWarningMessage("Wallaby.js trial session is over, please restart VS Code for a new trial session.")})})}},{key:"selectConfigFile",value:function(){var o=this,s=this,r=this._activeProjectRoot(),l=this._relativeConfigPath();r?T.findFiles("**/*wallaby*.*","**/node_modules/**",500).then(function(e){var t=[{label:"Automatic Configuration <project directory>",path:y.resolve(o._activeProjectRoot(),"auto.detect")},{label:"Automatic Configuration <custom directory>...",path:"selectDirectory"}],a=_.map(e,function(e){return{label:s._relativeNormalizedFilePath(e.fsPath,s._activeProjectRoot()),path:e.fsPath}}),n=[].concat(t,c(a)),i=r&&l?"Currently selected: "+y.join(y.basename(r),l):void 0;return x.showQuickPick(n,{placeHolder:i}).then(function(e){e&&("selectDirectory"===e.path?x.showOpenDialog({canSelectFolders:!0,defaultUri:b.Uri.file(T.rootPath),openLabel:"Select Folder"}).then(function(e){if(e&&e[0]){var t=s._relativeNormalizedFilePath(e[0].fsPath,s._activeProjectRoot());s._configFile(y.resolve(o._activeProjectRoot(),t,"auto.detect")),s.start()}}):(s._configFile(e.path),s.start()))})}):x.showWarningMessage("Please open some folder/project before selecting configuration.")}},{key:"playTraceNextStep",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this._requestTrace(e)}},{key:"playTraceNextStepOver",value:function(){this._requestTrace({over:!0})}},{key:"playTraceNextStepOut",value:function(){this._requestTrace({out:!0})}},{key:"playTracePrevStep",value:function(){this._requestTrace({back:!0})}},{key:"playTracePrevStepOver",value:function(){this._requestTrace({back:!0,over:!0})}},{key:"playTracePrevStepOut",value:function(){this._requestTrace({back:!0,out:!0})}},{key:"playTraceForwardToSelection",value:function(){this._playTraceToSelection()}},{key:"playTraceBackwardToSelection",value:function(){this._playTraceToSelection({back:!0})}},{key:"openCallStackFrame",value:function(e){var t=this,a=!e.noTrace;a?_.each(x.visibleTextEditors,function(e){return t._destroyStackTraceDecorations(e)}):(this._destroyAllValueCallStackDecorations(),clearTimeout(this._destroyAllValueCallStackDecorationsTimeout),this._destroyAllValueCallStackDecorationsTimeout=setTimeout(function(){return t._destroyAllValueCallStackDecorations()},2e3)),this._navigateWithTraceHighlight(e,a?this._activeTraceCallStackFrameDecorationType:this._activeValueCallStackFrameDecorationType),a&&this._traceExplorer.updateTraceContext(e)}},{key:"_destroyAllValueCallStackDecorations",value:function(){var t=this;_.each(x.visibleTextEditors,function(e){return t._destroyValueCallStackDecorations(e)})}},{key:"revealTraceStep",value:function(e){e&&this._navigateWithTraceHighlight(e,this._activeTraceFrameDecorationType)}},{key:"stopTraceNavigation",value:function(){var t=this;this._traceExplorer.stopTraceNavigation(),_.each(x.visibleTextEditors,function(e){return t._destroyStackTraceDecorations(e)}),this._updateStatus()}},{key:"_openWallabyTools",value:function(){var t=this,a=x.activeTextEditor;this._traceExplorer.traceBeingNavigated()&&(b.commands.executeCommand("workbench.view.extension.wallaby"),setTimeout(function(){if(a&&a.document){var e=t._getDocumentFilePath(a.document);e&&t._session&&t._session.filesToTrack[e]&&x.showTextDocument(a.document,{preserveFocus:!1})}},400))}},{key:"_playTraceToSelection",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=x.activeTextEditor;t&&(e.line=u._activeLine(),e.file=this._getDocumentFilePath(t.document),this._requestTrace(e))}},{key:"_requestTrace",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this._session&&this._traceExplorer.requestTrace(e).then(function(e){return t._processTraceNavigation(e,!1)})}},{key:"_processTraceNavigation",value:function(e){var t=this,a=arguments.length<=1||void 0===arguments[1]||arguments[1];return e&&e.restart&&(a=!1,this._openWallabyTools()),_.each(x.visibleTextEditors,function(e){return t._destroyStackTraceDecorations(e)}),this._traceExplorer.traceNavigated(e),this._updateStatus(),!e&&this._traceExplorer.lastActiveStep()?this._navigateWithTraceHighlight(this._traceExplorer.lastActiveStep(),this._activeTraceFrameWithNowhereToGoDecorationType,a):e?this._navigateWithTraceHighlight(e,this._activeTraceFrameDecorationType,a):void 0}},{key:"_navigateWithTraceHighlight",value:function(s,r,e){var t=this,a=function(e){var t=s.range[0]!==s.range[2],a=s.range[0]-1,n=e.document&&e.document.lineAt(a),i=s.range[1],o=!i&&n?n.firstNonWhitespaceCharacterIndex:i;t?e.setDecorations(r,[new b.Range(a,o,a,1e4)]):e.setDecorations(r,[new b.Range(a,o,s.range[2]-1,s.range[3])])};if(!e)return this._navigate(s.file,s.loc).then(a);var n=_.find(x.visibleTextEditors,function(e){return e&&e.document&&t._getDocumentFilePath(e.document)===s.file});return n?a(n):void 0}},{key:"openWallabyApp",value:function(){try{o("openurl").open(this._getWallabyAppUrl())}catch(e){}}},{key:"_getWallabyAppUrl",value:function(){return this._started?"http://localhost:51245/":"https://wallabyjs.com/app/"}},{key:"showFailingTests",value:function(){this._failingTestsOutput.show(),this._stats&&u._outputTestResults(this._failingTestsOutput,this._stats,!0,this._testFilterToggled)}},{key:"statusBarCommand",value:function(){this.showFailingTests(),this._traceExplorer.traceBeingNavigated()&&(b.commands.executeCommand("wallaby.revealTraceStep",this._traceExplorer.lastActiveStep()),b.commands.executeCommand("wallaby.traceExplorer.focus"))}},{key:"showCommandPalette",value:function(){var i=this;x.showQuickPick(_.map(i._commands,function(e,t){var a={label:t},n=i._keyBindings[e.command];return n&&(a.description=i._formatShortcut(n)),a})).then(function(e){return e&&b.commands.executeCommand(i._commands[e.label].command)})}},{key:"_formatShortcut",value:function(e){var a=this;if(e){var t=a._isMac?e.mac:e.key;return _.map(t.split(" "),function(e){return _.map(e.split("+"),function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);return a._isMac&&t.replace("Cmd","⌘").replace("Ctrl","⌃").replace("Alt","⌥").replace("Shift","⇧")||t}).join(a._isMac?"":"+")}).join(" ")}}},{key:"showLastScreenshot",value:function(){this._session&&this._screenshotProvider&&this._screenshotProvider.display()}},{key:"runLineTests",value:function(){this._runTests("line")}},{key:"debugTest",value:function(e){this._runTests("initialTraceRun",e)}},{key:"runFileTests",value:function(){this._runTests("file")}},{key:"runProjectTests",value:function(){this._runTests("project")}},{key:"updateTestSnapshots",value:function(e){this._runTests("line",e)}},{key:"updateFileSnapshots",value:function(){this._runTests("file")}},{key:"updateProjectSnapshots",value:function(){this._runTests("project")}},{key:"jumpToFailingTest",value:function(){this._jumpTo("failingTest")}},{key:"jumpToErrorSource",value:function(){this._jumpTo("errorSource")}},{key:"jumpToTest",value:function(){var a=this,e=new Promise(function(t){a._session&&a._session.requestTests({},function(e){t((e||[]).map(function(e){return{label:a._buildTestName(e.name,e.failing),description:e.suite,detail:e.file,test:e}}))})});x.showQuickPick(e,{matchOnDescription:!0,matchOnDetail:!0}).then(function(e){return e&&a._navigate(e.test.file,e.test.location)})}},{key:"showSideBySideDiff",value:function(){if(this._session){var e=x.activeTextEditor,t=e&&this._getDocumentFilePath(e.document),a=u._activeLine();this._session.requestError({file:t,line:a,type:"failingTest"},function(e){var t;e&&e.error&&(e.error.expected||e.error.actual)&&(t=b.commands).executeCommand.apply(t,["vscode.diff"].concat(c(g.diffCommandArguments(e.error.expected,e.error.actual))))})}}},{key:"showLineTests",value:function(){var t=this;if(this._session){var e=x.activeTextEditor,a=e&&this._getDocumentFilePath(e.document),n=u._activeLine();a&&n&&this._session.openedDocuments[a]&&this._session.requestLineReport({file:a,line:n},function(e){t._lineTestsOutput.show(),u._outputTestResults(t._lineTestsOutput,e.report.tests&&e.report.tests.length?e.report:"Line is not covered or covered not by tests",!0)})}}},{key:"showLineTestsFromMenu",value:function(){this.showLineTests()}},{key:"showValue",value:function(){this._showValue("show",!0)}},{key:"copyValue",value:function(){this._showValue("copy")}},{key:"copyDiagnosticsReportToClipboard",value:function(){this._session&&this._session.copyDiagnosticsReportToClipboard({editorVersion:b.version,pluginVersion:this._packageMetadata.version})}},{key:"runModeOnSave",value:function(){this._session.setRunMode("onsave")}},{key:"runModeImmediate",value:function(){this._session.setRunMode("immediate")}},{key:"runModeToggle",value:function(){this._session.setRunMode("toggle")}},{key:"forceCoreUpdate",value:function(){this._state.forceCoreUpdate()}},{key:"toggleTestFilter",value:function(){if(this._session){var e=x.activeTextEditor,t=e&&this._getDocumentFilePath(e.document),a=u._activeLine();this._session.toggleTestFilter({file:t,line:a})}}},{key:"resetTestFilter",value:function(){this._session&&(this._setContext("wallaby.testFilterToggled",!1),this._session.toggleTestFilter({}))}},{key:"resetUncovered",value:function(e){(e=e||x.activeTextEditor)&&(this._setContext("wallaby.uncoveredToggled",!1),e._wallabyUncoveredDisplayed&&this._destroyUncoveredDecorations(e))}},{key:"startExclusively",value:function(e,t){this.addToExclusiveTestRun(e,t,!0)}},{key:"startExclusivelyFromMenu",value:function(e){e&&this.addToExclusiveTestRun(e.fsPath,!0,!0)}},{key:"addToExclusiveTestRun",value:function(e,t,a){if(!e&&!t){var n=x.activeTextEditor;e=n&&n.document&&n.document.uri&&n.document.uri.fsPath}e&&(e=this._relativeNormalizedFilePath(e),!this._session||a?this.start(e):this._session.addTestLocations([e]))}},{key:"addToExclusiveTestRunFromMenu",value:function(e){e&&this.addToExclusiveTestRun(e.fsPath,!0)}},{key:"_showValue",value:function(e,t){var a=x.activeTextEditor;if(a){var n=this._session;if(n){var i=a.selection;if(i&&i.end){var o=this._getDocumentFilePath(a.document);if(o&&this._session.openedDocuments[o]){var s=a.document.getText();n.evaluateExpressionInEditor(o,s,[i.start.line+1,i.start.character,i.end.line+1,i.end.character],e),t&&this._scheduleOnResultsAvailable(o,i.end,function(){return b.commands.executeCommand("editor.action.showHover")})}}}}}},{key:"_scheduleOnResultsAvailable",value:function(e,t,a){this._runOnResultsAvailable={filePath:e,selectionEnd:t,action:a}}},{key:"_updateDiagnosticsCollection",value:function(e){var u=this;b.workspace.getConfiguration().get("wallaby.reportFailuresAsProblems",!0)&&function(){var c={};try{e&&e.tests&&e.tests.forEach(function(e){if(e.file&&e.errors){var t=u._absoluteFilePath(e.file);c[t]||(c[t]=[]);var a=e.path.join(" "),n=e.declarationLoc.split(":"),i=d(n,2),o=i[0],s=i[1],r=new b.Position(parseInt(o,10)-1,parseInt(s,10)),l={code:"",message:a,range:new b.Range(r,r),severity:b.DiagnosticSeverity.Error,source:"Wallaby.js",relatedInformation:e.errors.map(function(e){if(e.stack&&!(0<!e.stack.length)&&e.stack[0].loc&&e.stack[0].file)try{var t=((e.stack[0].loc||"")+":0").split(":"),a=d(t,2),n=a[0],i=a[1],o=parseInt(n,10)-1,s=parseInt(i,10),r=b.Uri.file(u._absoluteFilePath(e.stack[0].file));if(o<1)return;return{message:e.message,location:new b.Location(r,new b.Position(o,s))}}catch(e){return}}).filter(function(e){return!!e})};c[t].push(l),c[t].sort(function(e,t){return e.range.start.line===t.range.start.line?e.range.start.character-t.range.start.character:e.range.start.line-t.range.start.line})}})}catch(e){console.error(e)}Object.keys(c).forEach(function(e){var t=u._diagnosticEntries[e],a=c[e];if(!t||a.length!==t.length||JSON.stringify(a)!==JSON.stringify(t)){var n=b.Uri.file(e);u._diagnosticCollection.set(n,a)}}),Object.keys(u._diagnosticEntries).forEach(function(e){if(!c[e]){var t=b.Uri.file(e);u._diagnosticCollection.set(t,void 0)}}),u._diagnosticEntries=c}()}},{key:"_runScheduledActionOnResultsAvailable",value:function(){if(this._runOnResultsAvailable){var e=x.activeTextEditor;if(e)if(this._session){var t=e.selection;if(t&&t.end){var a=this._getDocumentFilePath(e.document);if(a&&this._session.openedDocuments[a]&&a===this._runOnResultsAvailable.filePath&&t.end===this._runOnResultsAvailable.selectionEnd)try{this._runOnResultsAvailable.action()}finally{delete this._runOnResultsAvailable}}}}}},{key:"copyExpressionPath",value:function(e){e&&e.copyExpressionPath()}},{key:"copyExpressionData",value:function(e){e&&e.copyExpressionData()}},{key:"goToExpressionSource",value:function(e){e&&e.data()&&e.data().expressionLocation&&this._navigate(e.data().expressionLocation.file,e.data().expressionLocation.loc)}},{key:"start",value:function(e){var t=this;if(this._activeProjectRoot()){var a=this;if(this.stop(!1),this._updating)this._onUpdated=function(){return t.start()};else if(this._configPath()||(this._setActiveProjectRootAndConfig(void 0,!0),this._configPath())){T.saveAll(!1),this._consoleOutputChannel.clear();var n="wallaby:autostart:notification";!this._context.globalState.get(n)&&b.workspace.getConfiguration().get("wallaby.startAutomatically",!0)&&(x.showWarningMessage("Please note: Wallaby.js is configured to start automatically if it was last running when your project was closed.","Update Setting to not Start Automatically").then(function(e){e&&b.workspace.getConfiguration().update("wallaby.startAutomatically",!1,!0)}),this._context.globalState.update(n,!0)),this._setProjectRunningState(!1),u._checkConfigurationSettings(),this._updateConfigurationFromSettings();var i=this._session=new a._Session;i.disposables=new h,i.filesToTrack=Object.create(null),i.openedDocuments=Object.create(null),i.projectCachePath=y.join(this._packagePath,"projects",u._hash(this._configPath())),i.start({localRoot:this._activeProjectRoot(),projectPath:i.projectCachePath,configPath:this._configPath(),testsPath:e,client:"VSCode",lkp:this._lkp}),i.on("started",function(e){a._started=!0,delete a._starting,a._consoleOutputChannel.appendLine(g.markupText("message","[Info]")+" Started Wallaby.js Core v"+e.version),a.emit("started",e)}),i.on("stopped",function(e){a.stop(!1),e.deactivate&&a._forceDeactivate()}),i.on("expiredLicense",function(){delete a._state.onFirstStart}),i.on("notification",function(e){return a.emit("notification",e)}),i.on("busy",function(){a._state.onFirstStart&&(a._state.onFirstStart(),delete a._state.onFirstStart),a.emit("busy")}),i.on("stats",function(e){return a.emit("stats",e)}),i.on("activeTestFileCoverageChanged",function(e){return a.emit("activeTestFileCoverageChanged",e)}),i.on("fileMessages",function(e){return a.emit("fileMessages",e)}),i.on("projectConfigured",function(e){return a.emit("projectConfigured",e)}),i.on("filesToTrack",function(e){return a.emit("filesToTrack",i,e)}),i.on("live",function(e){return a.emit("live",i,e)}),i.on("documentUpdates",function(e){return a.emit("documentUpdates",i,e)}),i.on("navigationRequested",function(e){return a._navigate(e.file,e.loc)}),i.on("testFilterToggled",function(e){a._setContext("wallaby.testFilterToggled",e.enabled),a._testFilterToggled=e.enabled,a._stats&&u._outputTestResults(a._failingTestsOutput,a._stats,!0,e.enabled),a._updateStatus()}),i.on("traceNavigationReset",function(){return t.stopTraceNavigation()}),i.on("traceNavigated",function(e){return t._processTraceNavigation(e)}),i.on("traceTestSelectionRequested",function(e){return t._selectTestForDebugging(e)}),i.on("testFilterTestSelectionRequested",function(e){return t._selectTestForFiltering(e)}),i.on("consoleError",function(e){return e&&_.each(e.split("\n"),function(e){return e&&a._consoleOutputChannel.appendLine(""+g.markupText("error","[Error] "+e.replace(/\u0000/g,"")))})}),i.on("consoleLog",function(e){return e&&_.each(e.split("\n"),function(e){return e&&a._consoleOutputChannel.appendLine(g.markupText("message","[Info]")+" "+e.replace(/\u0000/g,""))})}),this._starting=!0,this.emit("starting"),a._updateStatus("progress"),this._valueExplorer.reset(this,i),this._traceExplorer.reset(this,i),this._testFileCoverageExplorer.reset(),i.disposables.add(function(){delete t._runOnResultsAvailable,_.each(x.visibleTextEditors,function(t){_.each(a._coverageDecorationTypes,function(e){return t.setDecorations(e,[])}),a._hideAfterContentDecorationType&&t.setDecorations(a._hideAfterContentDecorationType,[]),a._destroyUncoveredDecorations(t),a._destroyStackTraceDecorations(t)})})}else u._notifyHowToSelectConfig(this)}else x.showWarningMessage("Please open some folder/project before starting wallaby.js.")}},{key:"_selectTestForDebugging",value:function(e){var i=this,t=e.tests,a=e.originalRequest;x.showQuickPick(_.map(t,function(e){var t=e.testData,a=t.slice(1,t.length-1).join(" > "),n=t[t.length-1];return{label:n=i._buildTestName(n,e.failing),description:a,detail:e.file,test:t}}),{matchOnDescription:!0,matchOnDetail:!0}).then(function(e){return e&&i._session&&i._session.runTests(n({initialTraceRun:!0,tests:[e.test]},a))})}},{key:"_selectTestForFiltering",value:function(e){var i=this,t=e.tests,a=e.file;if(t&&t.length){var n=t.map(function(e){var t=e.path,a=t.slice(1,t.length-1).join(" > "),n=t[t.length-1];return{label:n=i._buildTestName(n,e.failing),description:e.toggled?"$(filter) "+a:a,detail:e.file,test:t}});x.showQuickPick(n,{matchOnDescription:!0,matchOnDetail:!0}).then(function(e){return e&&i._session&&i._session.toggleTestFilter({file:a,test:e.test})})}}},{key:"_updateConfigurationFromSettings",value:function(){try{var e=b.workspace.getConfiguration();if(e){this._suppressExpirationNotifications=e.get("wallaby.suppressExpirationNotifications",!1),this._failingTestsOutput&&this._failingTestsOutput.setContentLimit(e.get("wallaby.outputContentSize",0));var t=e.get("wallaby.node",""),a=e.get("wallaby.useWsl",!1);t&&(process.env.WALLABY_NODE=t),process.env.WALLABY_USE_WSL=a}}catch(e){}}},{key:"stop",value:function(e){this._diagnosticCollection.clear(),e||this._setProjectRunningState(!1);var t=this._session;delete this._started,delete this._starting,delete this._session,delete this._stats,t&&(t.disposables&&t.disposables.dispose(),t.stop(),delete t.filesToTrack,delete t.openedDocuments,delete t.disposables,this.emit("stopped"),this._update&&(this._onUpdate(this._update),delete this._update),this._consoleOutputChannel.appendLine(g.markupText("message","[Info]")+" Wallaby.js stopped"),this._valueExplorer.reset(),this._traceExplorer.reset(),this._testFileCoverageExplorer.reset())}},{key:"_updateAvailable",value:function(e){this._started?this._update=e:this._onUpdate(e)}},{key:"_onUpdate",value:function(e){var t=this;this._updating=!0,e(function(){t._updating=!1,t._onUpdated&&(t._onUpdated(),delete t._onUpdated)})}},{key:"openFile",value:function(t){var a=this;if(t&&t.path){var e=this._absoluteFilePath(t.path);e&&x.showTextDocument(b.Uri.file(e)).then(function(e){return t.showCoverage&&a._showUncovered(e,void 0,!0)})}}},{key:"toggleUncovered",value:function(){var e=x.activeTextEditor;if(e){var t=!!e._wallabyUncoveredDisplayed;this._destroyUncoveredDecorations(e),this._setContext("wallaby.uncoveredToggled",!1),t||this._showUncovered(e)}}},{key:"_destroyUncoveredDecorations",value:function(e){e&&(e.setDecorations(this._uncoveredRegionDecorationType,[]),delete e._wallabyUncoveredDisplayed)}},{key:"_destroyStackTraceDecorations",value:function(e){if(e)try{e.setDecorations(this._activeTraceFrameDecorationType,[]),e.setDecorations(this._activeTraceCallStackFrameDecorationType,[]),e.setDecorations(this._activeTraceFrameWithNowhereToGoDecorationType,[])}catch(e){}}},{key:"_destroyValueCallStackDecorations",value:function(e){if(e)try{e.setDecorations(this._activeValueCallStackFrameDecorationType,[])}catch(e){}}},{key:"showLicense",value:function(){var h=this,p=this,g="";try{g=JSON.parse(Buffer.from(v.readFileSync(this._ol).toString(),"base64"))}catch(e){g={}}var f="";try{f=v.readFileSync(p._lkp).toString()}catch(e){}x.showInputBox({value:g.email&&g.email.length?g.email:100<f.length?f:"",prompt:"Enter your wallaby.js license key"}).then(function(t){if(!_.isUndefined(t))if(/^[a-zA-Z0-9_+&*-]+(?:\.[a-zA-Z0-9_+&*-]+)*@(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,63}$/.test(t))try{!function(){g.email=t.trim(),g.lastUpdate=(new Date).getTime(),v.writeFileSync(h._ol,Buffer.from(JSON.stringify(g)).toString("base64")),h._activeLicenseSession&&(h._activeLicenseSession.stop(),h._activeLicenseSession=null);var e=new h._Session;e.stop=function(){e===h._activeLicenseSession&&(h._activeLicenseSession=null)},e.start({localRoot:p._lkp,projectPath:p._lkp,configPath:p._lkp,client:"VSCode",lkp:h._lkp,ol:!0}),e.on("notification",function(e){return p.emit("notification",e)}),h._activeLicenseSession=e}()}catch(e){x.showErrorMessage("Unable to save email activation request: "+e.message)}else{try{v.unlinkSync(h._ol)}catch(e){}var e=f,a=t||"",n=!!p._parseLicenseKey(e),i=p._parseLicenseKey(a),o=!!i,s=!1;if(o||!a&&n)try{if(v.writeFileSync(p._lkp,a),i.isBundle){var r=y.join(m.homedir(),".quokka"),l=y.join(r,".qlc");v.existsSync(r)||v.mkdirSync(r),v.writeFileSync(l,a);var c=y.join(r,"config.json"),u={};try{var d=v.readFileSync(c).toString();u=JSON.parse(d)}catch(e){}u.pro=!0,v.writeFileSync(c,JSON.stringify(u)),b.commands.executeCommand("quokka.switchToPro").catch(function(e){})}s=o}catch(e){x.showErrorMessage("Unable to save license key: "+e.message),s=!1}else x.showWarningMessage("The entered license key is not a valid wallaby.js license key");s&&(x.showInformationMessage("Wallaby.js is licensed to: "+i.licensee+". Free upgrades until: "+i.expiration),p.stop(!1),p._state.licenseChanged())}})}},{key:"_parseLicenseKey",value:function(e){if(_.isString(e))try{var t=this._utils.parseKey(e);if(t.licenseeName&&t.expirationDateString&&(~t.licensedProduct.indexOf("(Freedom)")||~t.licensedProduct.indexOf("(VS Code)")))return{licensee:t.licenseeName,isBundle:0===t.licensedProduct.indexOf("Wallaby.js + Quokka.js"),expiration:t.expirationDateStringFormatted||t.expirationDateString}}catch(e){return}}},{key:"_showUncovered",value:function(t,e,a){var n=this;if(this._session){var i=t&&this._getDocumentFilePath(t.document);i&&(a||this._session.openedDocuments[i])&&(a&&(t._wallabySuppressUncoveredReset=!0),this._setContext("wallaby.uncoveredToggled",!0),this._session.requestUncoveredRegions({file:i,line:e},function(e){return n._highlightUncovered(t,e.ranges)}))}}},{key:"_highlightUncovered",value:function(e,t){e._wallabyUncoveredDisplayed=!0,e.setDecorations(this._uncoveredRegionDecorationType,_.map(t,function(e){return new b.Range(e[0]-1,e[1],e[2]-1,e[3])}))}},{key:"_jumpTo",value:function(e){var t=this;if(this._session){var a=x.activeTextEditor,n=a&&this._getDocumentFilePath(a.document),i=u._activeLine();this._session.requestLocation({file:n,line:i,type:e},function(e){return t._navigate(e.file,e.loc)})}}},{key:"_runTests",value:function(e,t){if(this._session){var a=void 0,n=void 0;if(t&&(a=_.isNumber(t)?t:(n=t.file,t.loc&&parseInt((t.loc+"").split(":")[0],10))),!n){var i=x.activeTextEditor;n=i&&this._getDocumentFilePath(i.document)}a||(a=("line"===e||"initialTraceRun"===e)&&u._activeLine()),this._session.runTests({file:"project"!==e&&n,line:a,initialTraceRun:"initialTraceRun"===e,evaluateExpression:"valueLine"===e})}}},{key:"_execute",value:function(e){if(e&&e.command)return"function"==typeof e.command?e.command(e):~e.command.indexOf("wallaby.")?b.commands.executeCommand(e.command):this[e.command]()}},{key:"_getDocumentFilePath",value:function(e){return e.uri&&e.uri.fsPath&&this._relativeNormalizedFilePath(e.uri.fsPath)}},{key:"_observeDocuments",value:function(n){var i=this,t=this;if(!n.isDisposed()){var o={};x.visibleTextEditors.forEach(function(e){if(e&&e.document&&e.document.isDirty&&!o[e.document.fileName]&&(o[e.document.fileName]=!0,!e.document.uri||!e.document.uri.scheme||"file"===e.document.uri.scheme)){var t=i._getDocumentFilePath(e.document);if(t){var a=e.document.getText();n.fileChangedInEditor(t,a,void 0)}}}),n.disposables.add(T.onDidChangeTextDocument(function(e){return t._processDocumentContentChange(n,e.document,e.contentChanges)})),this._processOpenedEditors(n),n.disposables.add(x.onDidChangeActiveTextEditor(function(e){e&&(n.activeEditor===e&&(n.filesWithSameEditorReActivated||(n.filesWithSameEditorReActivated=Object.create(null)),n.filesWithSameEditorReActivated[t._getDocumentFilePath(e.document)]=!0),n.activeEditor=e,t._revealActiveTraceStepIfRequired(e)),t._setContext("wallaby.uncoveredDisplayed",!1),t._processOpenedEditors(n),t._displayStatusForActiveEditor(n)})),n.disposables.add(function(){delete n.activeEditor}),n.disposables.add(x.onDidChangeTextEditorSelection(function(e){return t._handleEditorSelectionChange(n,e)}))}}},{key:"_revealActiveTraceStepIfRequired",value:function(e){if(this._traceExplorer.traceBeingNavigated()){var t=this._traceExplorer.lastActiveStep();if(t&&e.document)this._getDocumentFilePath(e.document)===t.file&&this._navigateWithTraceHighlight(t,this._activeTraceFrameDecorationType,!0)}}},{key:"_handleEditorSelectionChange",value:function(e,t){if(t&&t.selections&&t.selections.length){var a=t.selections[0];!this._traceExplorer.traceBeingNavigated()||a.start.line===a.end.line&&a.start.character===a.end.character||this._showValue("show")}}},{key:"_displayStatusForActiveEditor",value:function(e){var t=this;if(e.isDisposed())return t._updateStatusExtension();var a=x.activeTextEditor;if(!a)return t._updateStatusExtension();var n=t._getDocumentFilePath(a.document);if(n){var i=e.openedDocuments[n];if(!i)return t._updateStatusExtension();i.coverage&&t._updateStatusExtension(i.coverage)}}},{key:"_processOpenedEditors",value:function(l){var i=this;if(!l.isDisposed()){var o=_.reduce(x.visibleTextEditors,function(e,t){if(t){var a=i._getDocumentFilePath(t.document);if(a&&l.filesToTrack[a]){var n=e[a];n||(n=e[a]=Object.create(null)),n[t._id]=!0}}return e},{});_.each(o,function(e,t){var a=_.keys(e).length,n=l.openedDocuments[t],i=a;if(n?0!==(i=a-n.editorCount)&&(n.editorCount=a):n=l.openedDocuments[t]={changes:[],path:t,editorCount:i},0!==i)for(var o=0<i?function(){return l.fileOpenedInEditor(t)}:function(){return l.fileClosedInEditor(t)},s=0,r=Math.abs(i);s<r;s++)o();else(!_.isEqual(n.editors,e)||l.filesWithSameEditorReActivated&&l.filesWithSameEditorReActivated[t])&&(l.fileClosedInEditor(t),l.fileOpenedInEditor(t));n.editors=e}),_.each(l.openedDocuments,function(e,t){if(!o[t]){for(var a=0,n=e.editorCount;a<n;a++)l.fileClosedInEditor(t);delete l.openedDocuments[t]}}),delete l.filesWithSameEditorReActivated}}},{key:"_processDocumentContentChange",value:function(e,t,a){if(!(e.isDisposed()||t&&t.uri&&t.uri.scheme&&"file"!==t.uri.scheme)){var n=this._getDocumentFilePath(t),i=e.openedDocuments[n];i&&(i.changeTs=S++,i.changes=i.changes.concat(a),this._hideMessagesForChangedRanges(i.changes),this._onceDocumentStopsChanging(e,i,t))}}},{key:"_onceDocumentStopsChanging",value:function(e,t,a){!e.isDisposed()&&t.changes.length&&(e.fileChangedInEditor(t.path,a.getText(),{start:_.chain(t.changes).map(function(e){return e.range.start.line}).min().value()+1,end:_.chain(t.changes).map(function(e){return e.range.end.line}).max().value()+1}),t.changes=[],this._destroyUncoveredDecorations(x.activeTextEditor))}},{key:"_updateStatus",value:function(e){var t=this;if(clearTimeout(this._statusUpdateTimeout),e||(e=_.isString(this._stats)?"failing":this._stats?this._stats.failingNumber||this._stats.errors.length?"failing":"passing":void 0),e){if("progress"===e)this._statusBar.displayProgress();else{this._statusBar.stopProgress();var a=t._traceExplorer.traceBeingNavigated()?"$(bug)   ":t._testFilterToggled?"$(filter)   ":"";_.isString(this._stats)?t._statusBar.setMainText(a+"✗                "):t._statusBar.setMainText(a+"✗ "+_.pad(this._stats.failingNumber||0,3," ","right")+" ✔ "+_.pad(this._stats.totalNumber-this._stats.failingNumber||0,5," ","right")),this._stats&&this._stats.totalNumber&&this._setProjectRunningState(!0),t._statusBar.updateText()}this._statusBar.show()}}},{key:"_updateStatusExtension",value:function(e){this._statusBar.setExtensionText(e||void 0),this._statusBar.updateText()}},{key:"_continueTrial",value:function(){this._session&&this._session.continueTrial()}},{key:"_openPurchasePage",value:function(){try{o("openurl").open("https://wallabyjs.com/purchase")}catch(e){}}},{key:"_openPhantomJsDocs",value:function(){try{o("openurl").open("https://wallabyjs.com/docs/integration/phantomjs2.html")}catch(e){}}},{key:"_openAutoConfigDocs",value:function(){try{o("openurl").open("https://wallabyjs.com/docs/intro/config.html")}catch(e){}}},{key:"_requestTrialLicense",value:function(){b.window.showInputBox({prompt:"Wallaby.js: email address for trial license",ignoreFocusOut:!0,placeHolder:"user@domain.com"}).then(function(e){if(void 0!==e){var t=o("https"),a=JSON.stringify({email:e,type:"wallaby"}),n={hostname:"x55r2pae4l.execute-api.us-east-1.amazonaws.com",port:443,path:"/Prod/bc88894221b34ae4adac5c39a51547a2",method:"POST",headers:{"Content-Type":"application/json","Content-Length":Buffer.byteLength(a)}},i=t.request(n,function(e){200===e.statusCode?b.window.showInformationMessage("Your Wallaby.js trial license request has been processed. Please check your email."):b.window.showErrorMessage("Something went wrong processing your Wallaby.js trial license request. Please send us an email instead to hello@wallabyjs.com")});i.on("error",function(e){b.window.showErrorMessage("Something went wrong processing your Wallaby.js trial license request. Please send us an email instead to hello@wallabyjs.com"),console.error(e)}),i.write(a),i.end()}})}},{key:"_removeStatus",value:function(){this._statusBar.hide()}},{key:"_updateDocuments",value:function(n,i){var o=this;if(!n.isDisposed()){var c=this;_.each(x.visibleTextEditors,function(a){var s=a.document,e=c._getDocumentFilePath(a.document),r=n.openedDocuments[e]||{};r.messagesByLine=Object.create(null),r.testDeclarations=Object.create(null),delete r.coverage;var t=i[e];if(t&&(a._wallabySuppressUncoveredReset?delete a._wallabySuppressUncoveredReset:o.resetUncovered(a),t.lines)){r.updateTs=S++,t.coverage&&_.isNumber(t.coverage.value)&&(r.coverage=t.coverage.value+"%");var l={0:[],1:[],2:[],3:[],4:[],5:[]};_.each(t.lines,function(e){var t=e.num-1;if(!(t<0||t>=s.lineCount)){var a=s.lineAt(t);if(a){var n={range:new b.Range(a.lineNumber,a.firstNonWhitespaceCharacterIndex,a.lineNumber,a.range.end.character)},i=e.err||e.log,o=e.longLog||i;o&&(n.hoverMessage=b.MarkdownString?new b.MarkdownString("```\n"+o+"\n```"):o),e.decl?(r.testDeclarations[a.lineNumber]={filtered:e.meta&&e.meta.filtered},l[4!=e.state||e.err?e.state:0].push(n)):l[e.state].push(n),i&&(r.messagesByLine[e.num]=i,c._hideAfterContentDecorationType&&(n.renderOptions={after:{contentText:"  "+u._escapeInlineMessage(i)}}))}}}),_.each(l,function(e,t){return a.setDecorations(c._coverageDecorationTypes[t],e)}),c._scheduleHiddenMessagesDisplay()}})}}},{key:"_hideMessagesForChangedRanges",value:function(e){this._hideAfterContentDecorationType&&(clearTimeout(this._displayHiddenMessagesTimeout),this._messagesHiddenAt=+new Date,x.activeTextEditor.setDecorations(this._hideAfterContentDecorationType,e.map(function(e){return{range:new b.Range(e.range.start.line,0,e.range.end.line,Number.MAX_SAFE_INTEGER)}})))}},{key:"_scheduleHiddenMessagesDisplay",value:function(){if(this._hideAfterContentDecorationType){var t=this;clearTimeout(this._displayHiddenMessagesTimeout);var e=this._messagesHiddenAt?+new Date-this._messagesHiddenAt:400;this._displayHiddenMessagesTimeout=setTimeout(function(){try{_.each(x.visibleTextEditors,function(e){return e.setDecorations(t._hideAfterContentDecorationType,[])})}catch(e){}},Math.max(0,500-e))}}},{key:"navigate",value:function(e){return this._navigate(e.file,e.loc)}},{key:"_navigate",value:function(t,e){var a=this;if(t){var n=this._absoluteFilePath(t),i=void 0,o=void 0;return _.isNumber(e)?i=e:_.isArray(e)?(i=e[0],o=e[1]):_.isString(e)&&(e=e.split(":"),i=e[0]&&parseInt(e[0],10),o=e[1]&&parseInt(e[1],10)),_.isNumber(i)?i-=1:i=0,_.isNumber(o)||(o=0),T.openTextDocument(n).then(function(e){return x.showTextDocument(e,(_.find(x.visibleTextEditors,function(e){return e&&e.document&&a._getDocumentFilePath(e.document)===t})||{}).viewColumn)}).then(function(e){if(!o){var t=e.document&&e.document.lineAt(i);t&&(o=t.firstNonWhitespaceCharacterIndex)}var a=new b.Position(i,o);return e.revealRange(new b.Range(a,a),2),e.selection=new b.Selection(a,a),e})}}},{key:"_relativeConfigPath",value:function(){return this._configPath()&&y.relative(this._activeProjectRoot(),this._configPath())}},{key:"_absoluteFilePath",value:function(e){return this._configFolderPath()&&y.resolve(this._configFolderPath(),e)}},{key:"_relativeNormalizedFilePath",value:function(e,t){return(t||this._configFolderPath())&&this._utils.normalizePath(y.relative(t||this._configFolderPath(),e))}},{key:"_configByConvention",value:function(){var t=this;if(this._activeProjectRoot())return[{path:y.join(this._activeProjectRoot(),"node_modules","@jest","core","package.json"),majorVersion:24,minorVersion:0,revisionVersion:0},{path:y.join(this._activeProjectRoot(),"node_modules","@angular","cli","package.json"),majorVersion:8,minorVersion:2,revisionVersion:0}].find(function(e){if(v.existsSync(e.path))try{var t=JSON.parse(v.readFileSync(e.path).toString()).version.split("."),a=d(t,3),n=a[0],i=a[1],o=a[2],s=parseInt(n),r=parseInt(i),l=parseInt(o);if(s>e.majorVersion)return!0;if(s===e.majorVersion&&r>e.minorVersion)return!0;if(s===e.majorVersion&&r===e.minorVersion&&l>e.revisionVersion)return!0}catch(e){}return!1})?(x.showInformationMessage("Wallaby has set your project to use 'automatic configuration'. If you want to use a configuration file or have a mono-repo and only want to run for one project, you may select a different configuration.",{title:"Select Different Configuration",command:"selectConfigFile"},{title:"View Documentation",command:"_openAutoConfigDocs"}).then(t._executeCommand),y.join(t._activeProjectRoot(),"auto.detect")):_.chain(["wallaby.js","wallaby.conf.js",".wallaby.js",".wallaby.conf.js","wallaby.json",".wallaby.json"]).map(function(e){return y.join(t._activeProjectRoot(),e)}).find(function(e){return v.existsSync(e)}).value()}},{key:"_setContext",value:function(e,t){b.commands.executeCommand("setContext",e,t)}},{key:"_buildTestName",value:function(e,t){var a=this._isMac?"$(check) ":"✔ ",n=this._isMac?"$(chrome-close) ":"✗ ";return t?n+e:a+e}}],[{key:"_checkConfigurationSettings",value:function(){try{var e=b.workspace.getConfiguration();e&&!e.get("editor.glyphMargin",!0)&&x.showWarningMessage("Wallaby.js will not display coverage indicators because the `editor.glyphMargin` setting is set to `false`.")}catch(e){}}},{key:"_activeLine",value:function(){var e=x.activeTextEditor;return e&&e.selection&&e.selection.active&&e.selection.active.line+1}},{key:"_notifyHowToSelectConfig",value:function(e){return x.showWarningMessage("Please select wallaby.js configuration file.",{title:"Select Wallaby.js Config File",command:function(){return e.selectConfigFile()}}).then(e._executeCommand)}},{key:"_escapeInlineMessage",value:function(e){return u._cssEscape(e).replace(/'/g,'"')}},{key:"_hash",value:function(e){return i.createHash("md5").update(e).digest("hex").substr(0,16)}},{key:"_outputTestResults",value:function(e,t,a,n){var i=void 0,o=e.lines();e.build(t,n);var s=e.lines();if(!(i=a||s.length!==o.length))for(var r=0,l=s.length;r<l;r++)if(e.areDifferent(s[r],o[r])){i=!0;break}i&&e.render()}},{key:"_cssEscape",value:function(e){for(var t,a=String(e),n=a.length,i=-1,o="",s=a.charCodeAt(0);++i<n;)1<=(t=a.charCodeAt(i))&&t<=31||127==t||0==i&&48<=t&&t<=57||1==i&&48<=t&&t<=57&&45==s?o+="\\"+t.toString(16)+" ":o+=128<=t||45==t||95==t||48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122?a.charAt(i):"\\"+a.charAt(i);return o}}]),u}();e.exports=s},{"./compositeDisposable":3,"./screenshotContentProvider":5,"./testFileCoverageExplorer":6,"./testsOutputBuilder":7,"./traceExplorer":8,"./valueExplorer":9,crypto:void 0,"fs-extra":void 0,https:void 0,openurl:void 0,os:void 0,path:void 0,vscode:void 0}],5:[function(e,t,a){"use strict";var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var i=e("vscode"),o=e("path"),s=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._onDidChange=new i.EventEmitter,this._screenshotUriResolver=e,this._screenShotUri=i.Uri.parse("wallaby-screenshot://authority/wallaby-screenshot"),this._panel=void 0}return n(t,[{key:"display",value:function(){var e=this,t=function(){try{i.commands.executeCommand("vscode.previewHtml",i.Uri.parse("wallaby-screenshot://authority/wallaby-screenshot"),i.ViewColumn.Two)}catch(e){}};if(!this._panel)try{if(!i.window.createWebviewPanel)return void t();this._panel=i.window.createWebviewPanel("wallabyJsScreenshot","Wallaby Last Screenshot",i.ViewColumn.Two,{localResourceRoots:[i.Uri.file(o.dirname(this._screenshotUriResolver()))]})}catch(e){return void t()}this._panel.onDidDispose(function(){e._panel=void 0}),this.updateDisplay()}},{key:"updateDisplay",value:function(){this._panel.webview.html=this.provideTextDocumentContent()}},{key:"provideTextDocumentContent",value:function(){var e=void 0;try{e=this._screenshotUriResolver()}catch(e){return""}return'<!DOCTYPE html>\n            <html>\n            <head>\n            </head>\n            <body>\n                <img src="'+this._panel.webview.asWebviewUri(i.Uri.file(e)).toString()+"?ts="+ +new Date+'" />\n            </body>\n            </html>'}},{key:"update",value:function(){this._onDidChange.fire(this._screenShotUri),this._panel&&this.updateDisplay()}},{key:"onDidChange",get:function(){return this._onDidChange.event}}]),t}();t.exports=s},{path:void 0,vscode:void 0}],6:[function(e,t,a){"use strict";var i=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=e("vscode"),n=global._,r=function(){function t(e){o(this,t),this._context=e,this._treeDataProvider=new c,s.window.registerTreeDataProvider&&s.window.registerTreeDataProvider("wallaby.testFileCoverageExplorer",this._treeDataProvider)}return i(t,[{key:"reset",value:function(){this._treeDataProvider._rootNodes=[],this._treeDataProvider.refresh()}},{key:"update",value:function(e){var t=this,a=n.first(e.testFiles);this._treeDataProvider._rootNodes=[],a&&(this._treeDataProvider._rootNodes=[new l(this._context,a.file,a.coveredFiles.map(function(e){return new l(t._context,e)}))]),this._treeDataProvider.refresh()}}]),t}(),l=function(){function n(e,t,a){o(this,n),this.iconPath=s.ThemeIcon.File,this.resourceUri=s.Uri.file(t.name),this.label=t.name+""+this._formatCodeCoverage(t.coverage),this.description=""+t.dir,this.tooltip="Open "+t.path,this.command={command:"wallaby.openFile",arguments:[{path:t.path,showCoverage:t.coverage&&t.coverage.low}]},this.collapsibleState=a?2:0,this._children=a}return i(n,[{key:"_formatCodeCoverage",value:function(e){return e?" | "+e.value+"%"+(e.low?"  ⚠️":""):""}},{key:"getChildren",value:function(){return this._children?this._children:[]}}]),n}(),c=function(){function e(){o(this,e),this._onDidChangeTreeData=new s.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event}return i(e,[{key:"refresh",value:function(){this._onDidChangeTreeData.fire()}},{key:"getTreeItem",value:function(e){return e}},{key:"getChildren",value:function(e){return e?e.getChildren():Promise.resolve(this._rootNodes||[])}}]),e}();t.exports=r},{vscode:void 0}],7:[function(e,t,a){"use strict";var n=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();var p=e("vscode"),i={text:"",link:Array(2).join("​"),error:{start:"",end:" "},duration:Array(4).join("​"),suite:Array(5).join("​"),message:{start:"",end:" ",altEnd:" "+Array(6).join("​")},diffIns:Array(2).join("‌⁠"),diffDel:Array(2).join("‍"),tmpDiffIns:{start:"wsDiffIns",end:"weDiffIns"},tmpDiffDel:{start:"wsDiffDel",end:"weDiffDel"},linkNoStack:Array(2).join("​")},u="All tests covering the line of code:",d=" failing test",o="Launch Coverage & Test Explorer",s="Search Tests",r="Reset Test Filter",l=function(){function h(e,t,a,n,i,o,s,r,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h);var c=this;this._lines=[],this._links=[],this._lineAndColumnLinks=i,this._contentLimit=204800,this._channel=e,this._absolutePathResolver=t,this._failingTestsOutput=o,this._dmp=a,this.render=_.debounce(_.bind(this.render,this),300),this._timeEnd=" ms]​",this._sideBySideDiffSupported=r,this._wallabyAppLinkResolver=l,p.languages.registerDocumentLinkProvider&&n.add(p.languages.registerDocumentLinkProvider(s,{provideDocumentLinks:function(e){var t=e.lineAt(0);return t&&t.text&&(c._failingTestsOutput&&~t.text.indexOf(d)||!c._failingTestsOutput&&~t.text.indexOf(u))?c._links:[]}}))}return n(h,[{key:"build",value:function(e,t){var a=this,n=this;n._lines=[],n._links=[],_.isString(e)?n._appendLine(this._failingTestsOutput?"error":"message",0,e,this._failingTestsOutput&&"Error"):_.isObject(e)&&(this._failingTestsOutput?n._appendLine("none",0,this._markupStartToken("message")+e.failingNumber+d+(1===e.failingNumber?", ":"s, ")+(e.totalNumber-e.failingNumber)+" passing"+(e.additionalHeaderMessage?" "+e.additionalHeaderMessage:"")+this._markupEndToken("message")+" "+this._markupStartToken("link")+o+this._markupEndToken("link")+" | "+this._markupStartToken("link")+s+this._markupEndToken("link")+(t?" | "+this._markupStartToken("link")+r+this._markupEndToken("link"):"")+(e.errors&&e.errors.length?"\n":""),void 0,void 0,function(e){var t=n._lines.length;~e.indexOf(o)&&n._links.push({range:new p.Range(t,e.indexOf(o),t,e.indexOf(o)+o.length),target:p.Uri.parse(a._wallabyAppLinkResolver())}),~e.indexOf(r)&&n._links.push({range:new p.Range(t,e.indexOf(r),t,e.indexOf(r)+r.length),target:p.Uri.parse("command:wallaby.resetTestFilter")}),~e.indexOf(s)&&n._links.push({range:new p.Range(t,e.indexOf(s),t,e.indexOf(s)+s.length),target:p.Uri.parse("command:wallaby.jumpToTest")})}):n._appendLine("message",0,u,"Info"),_.each(e.errors,function(e){return n._outputError(e.message,e.stack,e.expected,e.actual,e.snapshot)}),_.each(e.tests,function(e){return n._outputTest(e)}))}},{key:"lines",value:function(){return this._lines}},{key:"render",value:function(){this._channel.clear();for(var e="",t=0,a=this._lines.length;t<a;t++){if((e+=this._lines[t]+"\n").length>this._contentLimit){e+="\n--- output truncated to "+this._contentLimit+' bytes (use the "wallaby.outputContentSize" user setting to change the bytes limit) ---\n';break}}this._channel.append(e.replace(/\u0000/g,""))}},{key:"show",value:function(){this._channel.show(!0)}},{key:"areDifferent",value:function(e,t){return!(e===t||~e.indexOf(this._timeEnd)&&~t.indexOf(this._timeEnd)&&e.substr(0,e.lastIndexOf("["))===t.substr(0,t.lastIndexOf("[")))}},{key:"setContentLimit",value:function(e){e&&(this._contentLimit=e)}},{key:"createDiffMarkdown",value:function(e,t,a,n){var i=[];return this._sideBySideDiffOutputLink(e,t,a,n,0,i),i.push("```wallaby-output"),this._diffOutput(e,t,0,i),i.push("```"),i.join("\n")}},{key:"_markupStartToken",value:function(e){var t=i[e];return _.isObject(t)?t.start:t}},{key:"_markupEndToken",value:function(e){var t=i[e];return _.isObject(t)?t.end:t}},{key:"_markupAltEndToken",value:function(e){var t=i[e];return _.isObject(t)?t.altEnd||t.end:t}},{key:"_sideBySideDiffOutputLink",value:function(e,t,a,n,i,o){var s,r,l,c,u,d=this;e=e||"",t=t||"",i=i||0,this._sideBySideDiffSupported&&(s="\nShow side-by-side diff",r=p.Uri.parse("command:_workbench.diff?"+JSON.stringify([h.diffCommandArguments(e,t)])),l="Update snapshot",c=p.Uri.parse("command:wallaby.updateTestSnapshots?"+JSON.stringify(n)),u=a&&n,o?p.MarkdownString&&(s="[Show side-by-side diff]("+r+")",u&&(s+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;["+l+"]("+c+")"),d._appendLine("linkNoStack",i,s,void 0,void 0,void 0,o)):d._appendLine("linkNoStack",i,s+(u?"  "+l:""),void 0,void 0,function(e,t){var a=d._lines.length;d._links.push({range:new p.Range(a,t,a,t+s.length-1),target:r}),u&&d._links.push({range:new p.Range(a,t+s.length+1,a,t+s.length+l.length+1),target:c})}))}},{key:"_updateSnapshotOutputLink",value:function(e,t){var n=this,i="Update snapshots\n",o=p.Uri.parse("command:wallaby.updateTestSnapshots?"+JSON.stringify(e));this._appendLine("linkNoStack",t,i,void 0,void 0,function(e,t){var a=n._lines.length;n._links.push({range:new p.Range(a,t,a,t+i.length-1),target:o})})}},{key:"_diffOutput",value:function(e,t,a,n){var o=this;e=e||"",t=t||"",a=a||0;var i=(n?"":"\n")+this._dmp[this._dmp.diff_prettyCompactHtml?"diff_prettyCompactHtml":"diff_prettyHtml"](this._dmp.diff_wordMode(e,t)).replace(/&para;<br>/g,"\n").replace(/<br>/g,"\n").replace(/<span class="dots">\.\.\.<\/span>/g,this._markupStartToken("duration")||"..."+this._markupEndToken("duration")).replace(/<\/?span[^>]*>/g,"").replace(/<ins[^>]*>/g,this._markupStartToken("tmpDiffIns")).replace(/<del[^>]*>/g,this._markupStartToken("tmpDiffDel")).replace(/<\/ins[^>]*>/g,this._markupEndToken("tmpDiffIns")).replace(/<\/del[^>]*>/g,this._markupEndToken("tmpDiffDel")).replace(/style="background:#e6ffe6;"/g,"").replace(/style="background:#ffe6e6;"/g,"").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&gt;/g,">"),s=0,r=0;this._appendLine("none",a,i,void 0,void 0,function(e){if(!e)return e;0<s&&(e=o._markupStartToken("diffIns")+e),0<r&&(e=o._markupStartToken("diffDel")+e);var t=(e.match(new RegExp(o._markupStartToken("tmpDiffIns"),"g"))||[]).length,a=(e.match(new RegExp(o._markupEndToken("tmpDiffIns"),"g"))||[]).length;s+=t-a;var n=(e.match(new RegExp(o._markupStartToken("tmpDiffDel"),"g"))||[]).length,i=(e.match(new RegExp(o._markupEndToken("tmpDiffDel"),"g"))||[]).length;return r+=n-i,0<s&&(e+=o._markupEndToken("diffIns")),0<r&&(e+=o._markupEndToken("diffDel")),e.replace(new RegExp(o._markupStartToken("tmpDiffIns"),"g"),o._markupStartToken("diffIns")).replace(new RegExp(o._markupEndToken("tmpDiffIns"),"g"),o._markupEndToken("diffIns")).replace(new RegExp(o._markupStartToken("tmpDiffDel"),"g"),o._markupStartToken("diffDel")).replace(new RegExp(o._markupEndToken("tmpDiffDel"),"g"),o._markupEndToken("diffDel"))},n)}},{key:"_outputError",value:function(e,t,a,n,i,o){var s=this;o=o||0,this._dmp&&(a||n?(this._sideBySideDiffOutputLink(a,n,i,t&&t.length&&t[0],o),this._diffOutput(a,n,o)):i&&this._updateSnapshotOutputLink(t&&t.length&&t[0],o)),this._appendLine("error",o,e),_.each(t,function(e){return s._outputLink(e,o+1)})}},{key:"_outputTest",value:function(n){var i=this,e=n.path&&_.last(n.path)||"",t=_.initial(n.path||[]).join(" "),o=""+this._markupStartToken("suite")+(t+" "+e).replace(/\r?\n|\r/g," ").replace(/\s\s+/g," ")+this._markupEndToken("suite"),a=_.isNumber(n.time)?"["+n.time+this._timeEnd:"",s=" Debug test";i._appendLine("text",1,""),i._appendLine("text",1,o+" "+this._markupStartToken("duration")+a+this._markupEndToken("duration")+this._markupStartToken("link")+s+this._markupEndToken("link"),void 0,void 0,function(e,t){var a=i._lines.length;i._links.push({range:new p.Range(a,t,a,t+o.length),target:p.Uri.parse(p.Uri.file(i._absolutePathResolver(n.file)).toString()+i._location(n.loc))}),i._links.push({range:new p.Range(a,e.lastIndexOf(s)+1,a,e.lastIndexOf(s)+s.length),target:p.Uri.parse("command:wallaby.debugTest?"+JSON.stringify(n))})}),_.each(n.errors,function(e){return i._outputError("\n"+e.message,e.stack,e.expected,e.actual,e.snapshot,2)}),n.messages&&n.messages.length&&(i._appendLine("message",2,"\nFrom console:"),_.each(n.messages,function(e){return i._appendLine("message",3,"\n"+e.text),i._outputLink(e,3)}))}},{key:"_outputLink",value:function(n,e){var i=this;if(n.file){var o=n.file+":"+n.loc;this._appendLine("link",e,o,void 0,n.context,function(e,t){var a=i._lines.length;i._links.push({range:new p.Range(a,t,a,t+o.length),target:p.Uri.parse(p.Uri.file(i._absolutePathResolver(n.file)).toString()+i._location(n.loc))})})}}},{key:"_location",value:function(e){var t=void 0,a=void 0;return _.isNumber(e)?t=e:_.isArray(e)?(t=e[0],a=e[1]):_.isString(e)&&(t=(e=e.split(":"))[0]&&parseInt(e[0],10),a=e[1]&&parseInt(e[1],10)),"#"+(this._lineAndColumnLinks&&_.isNumber(a)?t+","+(a+1):t)}},{key:"_appendLine",value:function(i,o,e,s,r,l,c){var u=this,t=e.split(/\r\n|\r|\n/);r&&r.replace&&(r=r.replace(/\r\n\s*/g," ").replace(/\n\s*/g," "));var d=[this._markupStartToken(i)||"",this._markupEndToken(i)||""];_.each(t,function(e){var t=(s?"["+s+"] ":"")+_.pad("",2*o,"   ")+("link"===i?"at "+(r?r+" ":""):"")+d[0],a=t+e+d[1];if(l){var n=l(a,t.length);n&&(a=n)}(c||u._lines).push(a)})}}],[{key:"markupText",value:function(e,t){var a=[h.prototype._markupStartToken(e)||"",h.prototype._markupEndToken(e)||""];return""+a[0]+t+a[1]}},{key:"diffCommandArguments",value:function(e,t){return[p.Uri.parse("wallaby-diff:data?"+Buffer.from(e).toString("base64")),p.Uri.parse("wallaby-diff:data?"+Buffer.from(t).toString("base64")),"Expected vs Actual"]}}]),h}();t.exports=l},{vscode:void 0}],8:[function(e,t,a){"use strict";var i=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=e("vscode"),s=e("path"),r=global._,l=function(){function t(e){o(this,t),this._callStackRootId=0,this._context=e,this._treeDataProvider=new h,n.window.registerTreeDataProvider&&n.window.registerTreeDataProvider("wallaby.traceExplorer",this._treeDataProvider)}return i(t,[{key:"reset",value:function(e,t){this._sessionContext&&this._sessionContext.runPendingUpdates(),this._treeDataProvider._rootNodes=[],delete this._callStackNodes,e&&t&&(this._sessionContext=new c(this._context,e,t)),this._setTraceBeingNavigatedContext(!1)}},{key:"update",value:function(e){var t=this;if(this._setTraceBeingNavigatedContext(!!e),e){if(e.callStack){var a=e.callStack[this._sessionContext.currentTraceFrame()];a&&a.stack&&(this._callStackNodes=a.stack.map(function(e){return new u(e,t._context)}))}e.tests&&(this._testNodes=r.map(e.tests,function(e){return new d(t._context,e,!0)})),e.files&&(this._fileNodes=r.map(e.files,function(e){return new d(t._context,e)})),e.length&&(this._traceLength=e.length,this._traceBeingNavigated&&this._currentStep&&(this._statusNode=this._navigationStatusNode(this._currentStep,this._traceLength))),this._sessionContext.receivedCallStack(e.callStack),this._sessionContext.runPendingUpdates(),this._updateNodes()}}},{key:"_navigationStatusNode",value:function(e,t){return{label:"Executed "+Math.floor((e.frame+1)/t*100)+"%",description:"step "+(e.frame+1)+" of "+t+" (click to locate)",iconPath:{light:this._context.asAbsolutePath("images/progress.light.svg"),dark:this._context.asAbsolutePath("images/progress.dark.svg")},command:{command:"wallaby.revealTraceStep",arguments:[e]}}}},{key:"_buildRootNodes",value:function(){var t=this,e=[];return this._statusNode&&e.push(this._statusNode),this._testNodes&&this._testNodes.length&&e.push({label:"Jump to",collapsibleState:2,iconPath:{light:this._context.asAbsolutePath("images/location.light.svg"),dark:this._context.asAbsolutePath("images/location.dark.svg")},getChildren:function(){var e=[];return t._testNodes&&t._testNodes.length&&(e=e.concat(t._testNodes)),t._fileNodes&&t._fileNodes.length&&e.push({label:"Loaded Files",collapsibleState:1,iconPath:{light:t._context.asAbsolutePath("images/files.light.svg"),dark:t._context.asAbsolutePath("images/files.dark.svg")},getChildren:function(){return t._fileNodes}}),e}}),this._traceBeingNavigated&&e.push({id:this._callStackRootId,label:"Call Stack",iconPath:{light:this._context.asAbsolutePath("images/callStack.light.svg"),dark:this._context.asAbsolutePath("images/callStack.dark.svg")},collapsibleState:1,getChildren:function(){if(t._callStackNodes){var e=t._callStackNodes;return delete t._callStackNodes,t._callStackRootId++,e}return t._sessionContext.requestCallStack(),new Promise(function(e){t._sessionContext.scheduleOnUpdate(e)})}}),e}},{key:"requestTrace",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this._sessionContext.requestTrace(e)}},{key:"_setTraceBeingNavigatedContext",value:function(e,t){n.commands.executeCommand("setContext","wallaby.traceBeingNavigated",e);var a=!!this._traceBeingNavigated;(this._traceBeingNavigated=e)||(this._statusNode=void 0),a!==e&&!t&&this._updateNodes()}},{key:"_updateNodes",value:function(){this._treeDataProvider._rootNodes=this._buildRootNodes(),this._treeDataProvider.refresh()}},{key:"traceBeingNavigated",value:function(){return this._traceBeingNavigated}},{key:"traceNavigated",value:function(e){e&&(this._currentStep=e,this._statusNode=this._navigationStatusNode(e,this._traceLength),this._sessionContext._traceContext.frame=e.frame),this._setTraceBeingNavigatedContext(!0,!0),this._updateNodes()}},{key:"lastActiveStep",value:function(){return this._currentStep}},{key:"updateTraceContext",value:function(e){return this._sessionContext.updateTraceContext(e)}},{key:"stopTraceNavigation",value:function(){this._setTraceBeingNavigatedContext(!1),this._sessionContext.stopTraceNavigation(),this.update()}}]),t}(),c=function(){function n(e,t,a){o(this,n),this._traceContext={},this._onUpdate=[],this._extensionContext=e,this._session=a,this._controller=t,this.id=a.id}return i(n,[{key:"asAbsolutePath",value:function(e){return this._extensionContext.asAbsolutePath(e)}},{key:"scheduleOnUpdate",value:function(e){this._onUpdate.push(e)}},{key:"runPendingUpdates",value:function(){r.each(this._onUpdate,function(e){try{return e()}catch(e){}}),this._onUpdate.length=0}},{key:"requestTrace",value:function(e){var a=this;return new Promise(function(t){return a._session.requestTrace(e,function(e){return t(e)})})}},{key:"updateTraceContext",value:function(e){this._session.isDisposed()||this._session.traceContext({currentFrame:e.frame})}},{key:"requestCallStack",value:function(){this._session.isDisposed()||(this._session.traceContext({captureCallStackFrame:this._traceContext.frame}),this._controller._runTests("valueLine"))}},{key:"receivedCallStack",value:function(e){this._callStack=e}},{key:"currentCallStack",value:function(){return this._callStack}},{key:"currentTraceFrame",value:function(){return this._traceContext.frame}},{key:"stopTraceNavigation",value:function(){this._session.isDisposed()||this._session.traceContext({stopNavigation:!0})}}]),n}(),u=function e(t,a){o(this,e),this._data=t,this.label=t.context||"...",this.description=s.basename(t.file)+":"+t.loc[0]+":"+t.loc[1],this.tooltip=this.label+" at "+t.file+":"+t.loc[0]+":"+t.loc[1],this.command={command:"wallaby.openCallStackFrame",arguments:[t]},this.iconPath={light:a.asAbsolutePath("images/location.light.svg"),dark:a.asAbsolutePath("images/location.dark.svg")}},d=function e(t,a,n){o(this,e),this.iconPath={light:t.asAbsolutePath("images/location.light.svg"),dark:t.asAbsolutePath("images/location.dark.svg")},n?(this.label="Test ",this.description=a.name,this.iconPath={light:t.asAbsolutePath("images/test.light.svg"),dark:t.asAbsolutePath("images/test.dark.svg")}):this.label=a.name,this.tooltip="Jump to "+a.name,this.command={command:"wallaby.playTraceNextStep",arguments:[{frame:a.start}]}},h=function(){function e(){o(this,e),this._onDidChangeTreeData=new n.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event}return i(e,[{key:"refresh",value:function(){this._onDidChangeTreeData.fire()}},{key:"getTreeItem",value:function(e){return e}},{key:"getChildren",value:function(e){return e?e.getChildren():Promise.resolve(this._rootNodes)}}]),e}();t.exports=l},{path:void 0,vscode:void 0}],9:[function(e,t,a){"use strict";var o=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=e("vscode"),c=global._,n=function(){function s(e,t){r(this,s),this._context=e,this._docsNode={label:"No logged values, click to see the feature docs",iconPath:this._context.asAbsolutePath("images/question.svg"),command:Object.defineProperties({command:"vscode.open"},{arguments:{get:function(){return[l.Uri.parse(t())]},configurable:!0,enumerable:!0}})},this._treeDataProvider=new d(this._docsNode),this._treeDataProvider._rootNodes={},l.window.registerTreeDataProvider&&l.window.registerTreeDataProvider("wallaby.valueExplorer",this._treeDataProvider)}return o(s,[{key:"reset",value:function(e,t){this._sessionContext&&this._sessionContext.runPendingUpdates(),this._treeDataProvider._rootNodes={},this._treeDataProvider.refresh(),e&&t&&(this._sessionContext=new i(this._context,e,t))}},{key:"update",value:function(i){var a,o=this;try{i.reset&&(this._treeDataProvider._rootNodes={},this._sessionContext.resetExpressionsToEvaluate()),i.specificFile||(a=i.files||{},c.each(o._treeDataProvider._rootNodes,function(e,t){a[t]||(delete o._treeDataProvider._rootNodes[t],o._sessionContext.removeFileFromExpressionsToEvaluate(t))})),c.each(i.files,function(n,e){var t,a;(!o._treeDataProvider._rootNodes[e]||n.messages&&n.messages.length)&&(t=new u(o._sessionContext,{id:e,name:n.name,queryPath:e.toString(),label:{name:n.name},fileNode:!0,disallowToCopyPath:!0,disallowToCopyData:!0,expandable:!0}),a=!1,t._children=c.chain(n.messages).map(function(e){var t=(e.valueBag||{}).data;if(t){t.name||(t.name=s.removeExcessiveSpacesTabsLineBreaks(e.context));var a=(e.loc.toString()||"").split(":")[0];return a&&(t.name="line "+a+(t.name?": "+t.name:"")),t.label=t.label||{},t.label.name=t.name,t.context=e.context,t.rootValueNode=!0,t.expressionLocation={file:n.name,loc:e.loc,line:parseInt(a,10)},t}}).filter(function(e){return!!e}).sortBy(function(e){return e.expressionLocation.line}).map(function(e){return a=a||e.autoExpand,new u(o._sessionContext,e,t,e.autoExpand)}).value(),t._children.length?a&&(t.collapsibleState=2):i.reset?t.collapsibleState=1:delete t._children,o._treeDataProvider._rootNodes[e]=t)}),this._sessionContext.runPendingUpdates(),this._treeDataProvider.refresh()}catch(e){console.warn("Error while updating Value Explorer nodes: "+e.stack)}}}],[{key:"removeExcessiveSpacesTabsLineBreaks",value:function(e){return e&&e.replace(/\r\n\s*/g," ").replace(/\n\s*/g," ")}}]),s}(),i=function(){function n(e,t,a){r(this,n),this._expressionsToEvaluate={},this._onUpdate=[],this._extensionContext=e,this._session=a,this._controller=t,this.id=a.id}return o(n,[{key:"asAbsolutePath",value:function(e){return this._extensionContext.asAbsolutePath(e)}},{key:"isPathRequested",value:function(e,t){if("string"!=typeof e){var a=this._expressionsToEvaluate,n=c.every(e,function(e){return!!a[e]&&(a=a[e],!0)});return n&&t?JSON.stringify(t)===JSON.stringify(a):n}}},{key:"requestNodes",value:function(e,t){var a=e._queryPath;if("string"!=typeof a){var n=this._expressionsToEvaluate;c.each(a,function(e){n[e]=n[e]||{},n=n[e]}),t&&(n.props=t.props,n.strLength=t.strLength,n.ranges=t.ranges),this._session.isDisposed()||(this._session.expressionsToEvaluate(this._expressionsToEvaluate),this._controller._runTests("valueLine",e.getRootExpressionLocation()))}else!this._session.isDisposed()&&this._session.getFileMessages(a)}},{key:"scheduleOnUpdate",value:function(e){this._onUpdate.push(e)}},{key:"copyToClipboard",value:function(e){!this._session.isDisposed()&&this._session.copyToClipboard(e)}},{key:"cancelPendingUpdates",value:function(){this._onUpdate=[]}},{key:"runPendingUpdates",value:function(){c.each(this._onUpdate,function(e){try{return e()}catch(e){}}),this._onUpdate.length=0}},{key:"removeFileFromExpressionsToEvaluate",value:function(t){var a=this;c.each(c.keys(this._expressionsToEvaluate),function(e){parseInt(e.split(",")[0],10)&&delete a._expressionsToEvaluate[t]})}},{key:"resetExpressionsToEvaluate",value:function(){this._expressionsToEvaluate={}}}]),n}(),u=function(){function i(e,t,a,n){r(this,i),this._context=e,this._parent=a,this._data=t,this.label=this._createLabel(),this.description=t.label&&t.label.description,this._queryPath=t.queryPath,this.id=(n?"A":"")+t.id,this.iconPath=this._getIconPath(),this.contextValue="",t.target&&(t.target.range=[t.target.line,0,t.target.line,1e4],t.target.noTrace=!0,this.command={command:"wallaby.openCallStackFrame",arguments:[t.target]}),t.disallowToCopyPath||(this.contextValue+="WallabyAllowToCopyPath"),t.disallowToCopyData||(this.contextValue+="WallabyAllowToCopyData"),t.rootValueNode&&(this.contextValue+="WallabyAllowToGoToSource"),this._autoExpand=n&&!this._data.cappedProps&&!this._data.capped&&!this._data.loadActionNode&&!this._data.rangeNode&&"string"!==this._data.type&&!this._data.getter&&!this._data.setter,this.collapsibleState=t.expandable?this._autoExpand?2:1:0,t.rangeNode&&(this._parentArray=a._parentArray||a,this._queryPath=this._parentArray._queryPath),t.fileNode&&(this.iconPath=l.ThemeIcon.File,this.resourceUri=l.Uri.file(t.name))}return o(i,[{key:"getChildren",value:function(){var a=this;if(this._children)return this._children;if("string"===this._data.type&&this._data.capped)return this._getChildren({strLength:Number.MAX_VALUE});if(this._data.loadActionNode)return this._getChildren({props:Number.MAX_VALUE});var e=(this._data.props||[]).map(function(e){return new i(a._context,e,a,a._autoExpand)});return e.length?Promise.resolve(e):this._data.rangeNode?this._getChildren({ranges:{props:JSON.parse(JSON.stringify(this._parentArray._data.props,function(e,t){return t.props&&(!t.props.length&&t===a._data||t.props.length&&!t.props[0].rangeNode)&&(t.props=!0),t})),length:this._parentArray._data.length}}):this._getChildren()}},{key:"copyExpressionPath",value:function(){(this._data||{}).expressionPath&&this._context.copyToClipboard(this._data.expressionPath.join(""))}},{key:"copyExpressionData",value:function(){this._data&&this._context.copyToClipboard(this._data)}},{key:"data",value:function(){return this._data}},{key:"getRootExpressionLocation",value:function(){for(var e=this;e&&!e._data.rootValueNode;)e=e._parent;if(e)return e._data.expressionLocation}},{key:"_getChildren",value:function(e){var a=this;return this._context.isPathRequested(this._queryPath,e)?[]:(this._context.requestNodes(this,e),new Promise(function(e,t){a._context.scheduleOnUpdate(e)}))}},{key:"_getIconPath",value:function(){if(this._data.getter)return this._context.asAbsolutePath("images/getter.svg");if(this._data.functionsNode)return this._context.asAbsolutePath("images/function.svg");if(this._data.loadActionNode)return this._context.asAbsolutePath("images/more.svg");if(this._data.error)return this._context.asAbsolutePath("images/error.svg");if(this._data.rangeNode)return this._context.asAbsolutePath("images/range.svg");if(this._data.callStackNode)return{light:this._context.asAbsolutePath("images/callStack.light.svg"),dark:this._context.asAbsolutePath("images/callStack.dark.svg")};if(this._data.callStackEntryNode)return{light:this._context.asAbsolutePath("images/location.light.svg"),dark:this._context.asAbsolutePath("images/location.dark.svg")};if(this._data.proxyNode)return{light:this._context.asAbsolutePath("images/usages.light.svg"),dark:this._context.asAbsolutePath("images/usages.dark.svg")};if(!this._data.fileNode){if(this._data.type)switch(this._data.type.toLowerCase()){case"string":if(this._data.capped)return this._context.asAbsolutePath("images/cappedString.svg");case"object":case"array":case"number":case"function":case"boolean":case"date":case"regexp":case"symbol":case"null":case"undefined":return this._context.asAbsolutePath("images/"+this._data.type.toLowerCase()+".svg")}return this._context.asAbsolutePath("images/object.svg")}}},{key:"_createLabel",value:function(){var e=this._data.label,t="";return e.name&&(t+=e.name),e.type&&(t+=": "+e.type+" "),e.value&&(t+=(e.type?"":": ")+e.value),t}}]),i}(),d=function(){function t(e){r(this,t),this._docsNode=e,this._onDidChangeTreeData=new l.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event}return o(t,[{key:"refresh",value:function(){this._onDidChangeTreeData.fire()}},{key:"getTreeItem",value:function(e){return e}},{key:"getChildren",value:function(e){if(e)return e.getChildren();if(c.isEmpty(this._rootNodes))return Promise.resolve([this._docsNode]);try{return Promise.resolve(c.chain(this._rootNodes).values().sortBy(function(e){return e._data.name}).value())}catch(e){console.warn("Error while trying to get Value Explorer root nodes: "+e.stack),Promise.resolve([])}}}]),t}();t.exports=n},{vscode:void 0}],10:[function(e,t,a){t.exports={name:"wallaby-vscode",displayName:"Wallaby.js",description:"Integrated Continuous Testing Tool for JavaScript.",version:"1.0.184",author:"Wallaby.js",homepage:"http://wallabyjs.com",bugs:{url:"https://github.com/wallabyjs/public/issues"},publisher:"WallabyJs",repository:{},engines:{vscode:"^1.25.0"},keywords:["testing","runner","unittest","JavaScript","TypeScript"],categories:["Other"],activationEvents:["*"],main:"./index",icon:"images/logo.png",galleryBanner:{color:"#ffffff",theme:"light"},contributes:{viewsContainers:{activitybar:[{id:"wallaby",title:"Wallaby Tools",icon:"images/logo.svg"}]},views:{wallaby:[{id:"wallaby.valueExplorer",name:"Value Explorer",when:"wallaby.started && wallaby.reportedAtLeastOnceLogValue"},{id:"wallaby.traceExplorer",name:"Debugger",when:"wallaby.traceBeingNavigated"},{id:"wallaby.testFileCoverageExplorer",name:"Test File Coverage",when:"wallaby.started"}]},commands:[{command:"wallaby.start",title:"Start",category:"Wallaby.js"},{command:"wallaby.stop",title:"Stop",category:"Wallaby.js"},{command:"wallaby.showCommandPalette",title:"Show Commands",category:"Wallaby.js"},{command:"wallaby.jumpToFailingTest",title:"Jump to Failing Test",category:"Wallaby.js"},{command:"wallaby.jumpToErrorSource",title:"Jump to Error Source",category:"Wallaby.js"},{command:"wallaby.toggleUncovered",title:"Toggle Uncovered Code Regions",category:"Wallaby.js"},{command:"wallaby.showLineTests",title:"Show Line Tests",category:"Wallaby.js"},{command:"wallaby.showLineTestsFromMenu",title:"Wallaby.js: Show Line Tests",category:"Wallaby.js"},{command:"wallaby.showFailingTests",title:"Show Failing Tests",category:"Wallaby.js"},{command:"wallaby.showSideBySideDiff",title:"Show Side-by-Side Diff",category:"Wallaby.js"},{command:"wallaby.runProjectTests",title:"Run Project Tests",category:"Wallaby.js"},{command:"wallaby.runFileTests",title:"Run File Tests",category:"Wallaby.js"},{command:"wallaby.runLineTests",title:"Run Line Tests",category:"Wallaby.js"},{command:"wallaby.startExclusively",title:"Start Exclusive Test Run",category:"Wallaby.js"},{command:"wallaby.startExclusivelyFromMenu",title:"Wallaby.js: Start Exclusive Test Run",category:"Wallaby.js"},{command:"wallaby.addToExclusiveTestRun",title:"Add To Exclusive Test Run",category:"Wallaby.js"},{command:"wallaby.addToExclusiveTestRunFromMenu",title:"Wallaby.js: Add To Exclusive Test Run",category:"Wallaby.js"},{command:"wallaby.updateProjectSnapshots",title:"Update Project Snapshots",category:"Wallaby.js"},{command:"wallaby.updateFileSnapshots",title:"Update File Snapshots",category:"Wallaby.js"},{command:"wallaby.updateTestSnapshots",title:"Update Test Snapshots",category:"Wallaby.js"},{command:"wallaby.showValue",title:"Show Value",category:"Wallaby.js"},{command:"wallaby.copyValue",title:"Copy Value",category:"Wallaby.js"},{command:"wallaby.openWallabyApp",title:"Launch Coverage & Test Explorer",category:"Wallaby.js"},{command:"wallaby.selectConfigFile",title:"Select Configuration",category:"Wallaby.js"},{command:"wallaby.showLastScreenshot",title:"Show Last Screenshot",category:"Wallaby.js"},{command:"wallaby.showLicense",title:"Manage License Key",category:"Wallaby.js"},{command:"wallaby.copyExpressionPath",title:"Copy Path",category:"Wallaby.js"},{command:"wallaby.copyExpressionData",title:"Copy Data",category:"Wallaby.js"},{command:"wallaby.goToExpressionSource",title:"Go to Source",category:"Wallaby.js"},{command:"wallaby.copyDiagnosticsReportToClipboard",title:"Copy Diagnostics Report",category:"Wallaby.js"},{command:"wallaby.runModeOnSave",title:"Make Current Session Run Only on Save",category:"Wallaby.js"},{command:"wallaby.runModeImmediate",title:"Make Current Session Run on Any Change",category:"Wallaby.js"},{command:"wallaby.runModeToggle",title:"Toggle Current Session Run Mode (Any Change/On Save)",category:"Wallaby.js"},{command:"wallaby.forceCoreUpdate",title:"Force Core Update",category:"Wallaby.js"},{command:"wallaby.toggleTestFilter",title:"Toggle Test Filter",category:"Wallaby.js"},{command:"wallaby.resetTestFilter",title:"Reset Test Filter",category:"Wallaby.js"},{command:"wallaby.resetUncovered",title:"Reset Uncovered Code Regions",category:"Wallaby.js"},{command:"wallaby.playTraceNextStep",title:"Step Into",category:"Wallaby.js",icon:{dark:"images/debug-step-into.dark.svg",light:"images/debug-step-into.light.svg"}},{command:"wallaby.playTracePrevStep",title:"Step Back Into",category:"Wallaby.js",icon:{dark:"images/debug-step-into-back.dark.svg",light:"images/debug-step-into-back.light.svg"}},{command:"wallaby.playTraceForwardToSelection",title:"Run to Active Line",category:"Wallaby.js",icon:{dark:"images/debug-continue.dark.svg",light:"images/debug-continue.light.svg"}},{command:"wallaby.playTraceBackwardToSelection",title:"Run Back to Active Line",category:"Wallaby.js",icon:{dark:"images/debug-continue-back.dark.svg",light:"images/debug-continue-back.light.svg"}},{command:"wallaby.playTraceNextStepOver",title:"Step Over",category:"Wallaby.js",icon:{dark:"images/debug-step-over.dark.svg",light:"images/debug-step-over.light.svg"}},{command:"wallaby.playTracePrevStepOver",title:"Step Back Over",category:"Wallaby.js",icon:{dark:"images/debug-step-over-back.dark.svg",light:"images/debug-step-over-back.light.svg"}},{command:"wallaby.playTraceNextStepOut",title:"Step Out",category:"Wallaby.js",icon:{dark:"images/debug-step-out.dark.svg",light:"images/debug-step-out.light.svg"}},{command:"wallaby.playTracePrevStepOut",title:"Step Back Out",category:"Wallaby.js",icon:{dark:"images/debug-step-out-back.dark.svg",light:"images/debug-step-out-back.light.svg"}},{command:"wallaby.openCallStackFrame",title:"Open Call Stack Frame",category:"Wallaby.js"},{command:"wallaby.revealTraceStep",title:"Reveal Trace Step",category:"Wallaby.js"},{command:"wallaby.stopTraceNavigation",title:"Stop Debugger",category:"Wallaby.js",icon:{dark:"images/stop.dark.svg",light:"images/stop.light.svg"}},{command:"wallaby.statusBarCommand",title:"Status Bar Command",category:"Wallaby.js"},{command:"wallaby.debugTest",title:"Debug Test",category:"Wallaby.js"},{command:"wallaby.jumpToTest",title:"Jump to Test",category:"Wallaby.js"},{command:"wallaby.openFile",title:"Open File",category:"Wallaby.js"}],menus:{"extension/context":[{command:"wallaby.showLicense",when:"extensionStatus == installed"},{command:"wallaby.forceCoreUpdate",when:"extensionStatus == installed"}],"explorer/context":[{command:"wallaby.startExclusivelyFromMenu",when:"!wallaby.started && explorerResourceIsFolder && resourceFilename != .idea && resourceFilename != .vs && resourceFilename != .vscode && resourceFilename != node_modules || !wallaby.started && resourceLangId == javascript && resourceFilename =~ /^(?!wallaby).*\\.js$/ && resourceFilename != jest.config.js || !wallaby.started && resourceLangId == javascriptreact || !wallaby.started && resourceLangId == typescript || !wallaby.started && resourceLangId == typescriptreact || !wallaby.started && resourceLangId == coffeescript || !wallaby.started && resourceLangId == vue",group:"WallabyGroup@1"},{command:"wallaby.addToExclusiveTestRunFromMenu",when:"wallaby.started && explorerResourceIsFolder && resourceFilename != .idea && resourceFilename != .vs && resourceFilename != .vscode && resourceFilename != node_modules || wallaby.started && resourceLangId == javascript && resourceFilename =~ /^(?!wallaby).*\\.js$/ && resourceFilename != jest.config.js || wallaby.started && resourceLangId == javascriptreact || wallaby.started && resourceLangId == typescript || wallaby.started && resourceLangId == typescriptreact || wallaby.started && resourceLangId == coffeescript || wallaby.started && resourceLangId == vue",group:"WallabyGroup@1"}],"editor/title":[{command:"wallaby.playTraceBackwardToSelection",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-999"},{command:"wallaby.playTracePrevStepOut",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-998"},{command:"wallaby.playTracePrevStep",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-997"},{command:"wallaby.playTracePrevStepOver",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-996"},{command:"wallaby.stopTraceNavigation",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-995"},{command:"wallaby.playTraceNextStepOver",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-994"},{command:"wallaby.playTraceNextStep",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-993"},{command:"wallaby.playTraceNextStepOut",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-992"},{command:"wallaby.playTraceForwardToSelection",when:"wallaby.started && wallaby.traceBeingNavigated",group:"navigation@-991"}],commandPalette:[{command:"wallaby.jumpToFailingTest",when:"wallaby.started"},{command:"wallaby.jumpToErrorSource",when:"wallaby.started"},{command:"wallaby.toggleUncovered",when:"wallaby.started && activeEditor"},{command:"wallaby.showLineTests",when:"wallaby.started && activeEditor"},{command:"wallaby.showLineTestsFromMenu",when:"false"},{command:"wallaby.showFailingTests",when:"wallaby.started"},{command:"wallaby.showSideBySideDiff",when:"wallaby.started && activeEditor"},{command:"wallaby.runProjectTests",when:"wallaby.started"},{command:"wallaby.runFileTests",when:"wallaby.started && activeEditor"},{command:"wallaby.runLineTests",when:"wallaby.started && activeEditor"},{command:"wallaby.startExclusively",when:"activeEditor"},{command:"wallaby.startExclusivelyFromMenu",when:"false"},{command:"wallaby.addToExclusiveTestRun",when:"activeEditor && wallaby.started"},{command:"wallaby.addToExclusiveTestRunFromMenu",when:"false"},{command:"wallaby.updateProjectSnapshots",when:"wallaby.started"},{command:"wallaby.updateFileSnapshots",when:"wallaby.started && activeEditor"},{command:"wallaby.updateTestSnapshots",when:"wallaby.started && activeEditor"},{command:"wallaby.showValue",when:"wallaby.started && activeEditor"},{command:"wallaby.copyValue",when:"wallaby.started && activeEditor"},{command:"wallaby.openWallabyApp",when:"wallaby.started"},{command:"wallaby.showLastScreenshot",when:"wallaby.started"},{command:"wallaby.copyDiagnosticsReportToClipboard",when:"wallaby.started"},{command:"wallaby.runModeOnSave",when:"wallaby.started"},{command:"wallaby.runModeImmediate",when:"wallaby.started"},{command:"wallaby.runModeToggle",when:"wallaby.started"},{command:"wallaby.copyExpressionPath",when:"false"},{command:"wallaby.copyExpressionData",when:"false"},{command:"wallaby.goToExpressionSource",when:"false"},{command:"wallaby.toggleTestFilter",when:"wallaby.started && activeEditor"},{command:"wallaby.resetTestFilter",when:"wallaby.started && wallaby.testFilterToggled"},{command:"wallaby.resetUncovered",when:"wallaby.started && wallaby.uncoveredToggled"},{command:"wallaby.playTraceNextStep",when:"false"},{command:"wallaby.playTracePrevStep",when:"false"},{command:"wallaby.playTraceForwardToSelection",when:"false"},{command:"wallaby.playTraceBackwardToSelection",when:"false"},{command:"wallaby.playTraceNextStepOver",when:"false"},{command:"wallaby.playTracePrevStepOver",when:"false"},{command:"wallaby.playTraceNextStepOut",when:"false"},{command:"wallaby.playTracePrevStepOut",when:"false"},{command:"wallaby.openCallStackFrame",when:"false"},{command:"wallaby.revealTraceStep",when:"false"},{command:"wallaby.stopTraceNavigation",when:"wallaby.started && wallaby.traceBeingNavigated"},{command:"wallaby.statusBarCommand",when:"false"},{command:"wallaby.debugTest",when:"wallaby.started && activeEditor"},{command:"wallaby.jumpToTest",when:"wallaby.started"},{command:"wallaby.openFile",when:"false"}],"view/title":[{command:"wallaby.playTraceBackwardToSelection",when:"view =~ /wallaby.traceExplorer/",group:"navigation@1"},{command:"wallaby.playTracePrevStepOut",when:"view =~ /wallaby.traceExplorer/",group:"navigation@2"},{command:"wallaby.playTracePrevStep",when:"view =~ /wallaby.traceExplorer/",group:"navigation@3"},{command:"wallaby.playTracePrevStepOver",when:"view =~ /wallaby.traceExplorer/",group:"navigation@4"},{command:"wallaby.stopTraceNavigation",when:"view =~ /wallaby.traceExplorer/ && wallaby.traceBeingNavigated",group:"navigation@5"},{command:"wallaby.playTraceNextStepOver",when:"view =~ /wallaby.traceExplorer/",group:"navigation@6"},{command:"wallaby.playTraceNextStep",when:"view =~ /wallaby.traceExplorer/",group:"navigation@7"},{command:"wallaby.playTraceNextStepOut",when:"view =~ /wallaby.traceExplorer/",group:"navigation@8"},{command:"wallaby.playTraceForwardToSelection",when:"view =~ /wallaby.traceExplorer/",group:"navigation@9"}],"view/item/context":[{command:"wallaby.copyExpressionPath",when:"viewItem =~ /WallabyAllowToCopyPath/"},{command:"wallaby.copyExpressionData",when:"viewItem =~ /WallabyAllowToCopyData/"},{command:"wallaby.goToExpressionSource",when:"viewItem =~ /WallabyAllowToGoToSource/"}],"editor/context":[{command:"wallaby.showLineTestsFromMenu",group:"WallabyGroup@1",when:"wallaby.started"}]},keybindings:[{command:"wallaby.showCommandPalette",key:"ctrl+shift+=",mac:"cmd+shift+="},{command:"wallaby.start",key:"ctrl+shift+r r",mac:"cmd+shift+r r"},{command:"wallaby.stop",key:"ctrl+shift+r s",mac:"cmd+shift+r s"},{command:"wallaby.runProjectTests",key:"ctrl+shift+r p",mac:"cmd+shift+r p",when:"wallaby.started"},{command:"wallaby.showLastScreenshot",key:"ctrl+shift+r h",mac:"cmd+shift+r h",when:"wallaby.started"},{command:"wallaby.runLineTests",key:"ctrl+shift+r c",mac:"cmd+shift+r c",when:"wallaby.started && editorTextFocus"},{command:"wallaby.runFileTests",key:"ctrl+shift+r f",mac:"cmd+shift+r f",when:"wallaby.started && editorTextFocus"},{command:"wallaby.jumpToFailingTest",key:"ctrl+shift+r o",mac:"cmd+shift+r o",when:"wallaby.started && editorTextFocus"},{command:"wallaby.jumpToErrorSource",key:"ctrl+shift+r p",mac:"cmd+shift+r p",when:"wallaby.started && editorTextFocus"},{command:"wallaby.toggleUncovered",key:"ctrl+shift+r u",mac:"cmd+shift+r u",when:"wallaby.started && editorTextFocus"},{command:"wallaby.showFailingTests",key:"ctrl+shift+r t",mac:"cmd+shift+r t",when:"wallaby.started"},{command:"wallaby.showLineTests",key:"ctrl+shift+r l",mac:"cmd+shift+r l",when:"wallaby.started && editorTextFocus"},{command:"wallaby.showSideBySideDiff",key:"ctrl+shift+r d",mac:"cmd+shift+r d",when:"wallaby.started && editorTextFocus"},{command:"wallaby.showValue",key:"ctrl+shift+r v",mac:"cmd+shift+r v",when:"wallaby.started && editorTextFocus"},{command:"wallaby.copyValue",key:"ctrl+shift+r x",mac:"cmd+shift+r x",when:"wallaby.started && editorTextFocus"},{command:"wallaby.resetUncovered",key:"Escape",mac:"Escape",when:"wallaby.started && wallaby.uncoveredToggled && editorTextFocus"},{command:"wallaby.resetTestFilter",key:"shift+escape",mac:"shift+escape",when:"wallaby.started && wallaby.testFilterToggled && editorTextFocus"},{command:"wallaby.stopTraceNavigation",key:"shift+f5",mac:"shift+f5",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.debugTest",key:"shift+f5",mac:"shift+f5",when:"wallaby.started && !wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceNextStep",key:"f11",mac:"f11",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceForwardToSelection",key:"f5",mac:"f5",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceNextStepOver",key:"f10",mac:"f10",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceNextStepOut",key:"shift+f11",mac:"shift+f11",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTracePrevStep",key:"ctrl+f11",mac:"ctrl+f11",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceBackwardToSelection",key:"ctrl+f5",mac:"ctrl+f5",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTracePrevStepOver",key:"ctrl+f10",mac:"ctrl+f10",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTracePrevStepOut",key:"ctrl+shift+f11",mac:"ctrl+shift+f11",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"}],languages:[{id:"wallaby-output"}],grammars:[{language:"wallaby-output",scopeName:"wallaby.output",path:"./wallaby-output.tmLanguage.json"}],configuration:{type:"object",title:"Wallaby configuration",properties:{"wallaby.startAutomatically":{description:"Starts Wallaby automatically if Wallaby was running when the folder/workspace was last opened",type:"boolean",default:!0},"wallaby.useHttpForDownload":{description:"Use HTTP protocol to download wallaby updates",type:"boolean",default:!1},"wallaby.strictSSL":{description:"Use strict SSL to download wallaby updates",type:"boolean",default:!0},"wallaby.noAutomaticInstall":{description:"Stop automatic wallaby core updates",type:"boolean",default:!1},"wallaby.showUpdateNotifications":{description:"Show wallaby core update notifications",type:"boolean",default:!0},"wallaby.suppressExpirationNotifications":{description:"Stop wallaby expiring license update reminders",type:"boolean",default:!1},"wallaby.node":{description:"Path to node.js executable that is used to run wallaby core",type:"string",default:""},"wallaby.useWsl":{description:"Use Windows Subsystem for Linux",type:"boolean",default:!1},"wallaby.reportFailuresAsProblems":{description:"Report Failing Tests to the VS Code Problems View",type:"boolean",default:!0},"wallaby.outputContentSize":{description:"Wallaby output content limit in bytes",type:"number",default:0},"wallaby.colors":{description:"Wallaby gutter indicators colors (requires a restart after change)",type:"object",default:{covered:"#62b455",errorPath:"#ffa0a0",errorSource:"#fe536a",notCovered:"#cccccc",partiallyCovered:"#d2a032"}}}}},devDependencies:{grunt:"*","grunt-babel":"5.0.1","grunt-browserify":"*","grunt-bump":"0.0.16","grunt-contrib-clean":"*","grunt-contrib-compress":"^0.12.0","grunt-contrib-copy":"*","grunt-contrib-uglify":"*",lodash:"*",vsce:"^1.46.0",vscode:"^1.1.21"},optionalDependencies:{"aws-sdk":"^2.353.0",keytar:"^4.10.0"},dependencies:{"adm-zip-mit":"0.4.12","fs-extra":"0.26.2",lockfile:"1.0.3",openurl:"1.1.1",q:"1.4.1",request:"2.88.0","tar-stream":"1.3.1","unbzip2-stream":"1.0.8"},__metadata:{id:"6766254a-8e43-4ebc-9b89-e5be39cb5318",publisherDisplayName:"Wallaby.js",publisherId:"9e43bb4e-4318-4e59-b5c2-df1109a963dd"},scripts:{postinstall:"node ./node_modules/vscode/bin/install",build:"node ./node_modules/grunt/bin/grunt",pub:"node ./node_modules/grunt/bin/grunt bump-only && npm run build && vsce publish && vsce package && node ./node_modules/grunt/bin/grunt publish-complete",release:"node ./docker/run.js"}}},{}]},{},[2]);