/*
 * Wallaby.js - v1.0.869
 * https://wallabyjs.com
 * Copyright (c) 2014-2020 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of Wallaby.js and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */
var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(t){o(t)}}function a(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}l((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(s=2&n[0]?o["return"]:n[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,o=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){l.label=n[1];break}if(6===n[0]&&l.label<s[1]){l.label=s[1],s=n;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(n);break}s[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(r){n=[6,r],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},_this=this,path=require("path"),fs=require("fs"),tracer=global.$_$tracer,workerId=tracer.workerId,utils=tracer._utils,localProjectRoot=path.dirname(global.wallaby._localNodeModules),originalCacheRoot=global.wallaby._originalCacheRoot,jasmineInitializerPath=path.join(__dirname,"jasmineInitializer.js"),jestInstalledAndConfigured=!1,jest,jestCLI,jestRuntime,jestConfig,JestTestScheduler,jestRunGlobalHook;process.env.VUE_CLI_BABEL_TRANSPILE_MODULES=!0,process.env.BABEL_ENV||(process.env.BABEL_ENV="test"),process.env.NODE_ENV||(process.env.NODE_ENV="test"),process.env.PUBLIC_URL="",utils.patchModulesCode([{files:["@jest/transform/build/ScriptTransformer"],replacements:[{from:"const getScriptCacheKey = (filename, instrument) => {",to:"const getScriptCacheKey = (filename, instrument) => { var wallabyKey = global.$_$tracer._fileCacheKey(filename); if (wallabyKey) return wallabyKey;"},{from:"constructor(config) {",to:"constructor(config) { var _getTransformer = this._getTransformer; this._getTransformer = function(filename) { var transformer = _getTransformer.apply(this, arguments); return global.$_$tracer._extendJestTransformer ? global.$_$tracer._extendJestTransformer(filename, transformer) : transformer; };"},{from:"!!this._config.transform && !!this._config.transform.length && !isIgnored",to:"!isIgnored"},{from:"transform(filename, options, fileSource) {",to:"transform(filename, options, fileSource) { var wallabyFileId = global.$_$tracer._fileId(filename); if (wallabyFileId) { global.$_$tracer.programScopeStartLoading(wallabyFileId); }"}]},{files:["jest-resolve/build/defaultResolver"],replacements:[{from:"const checkedPaths = new Map();",to:"const checkedPaths = new Map(); checkedPaths.get = function() {};"}]},{files:["jest-message-util/build/index"],replacements:[{from:"${renderedCallsite}\\n${stacktrace}",to:"${stacktrace}"}]},{files:["vue-jest/lib/process.js"],replacements:[{from:"return { code: output }",to:"return { code: output, scriptSrc: parts.script && parts.script.src }"}]},{files:["jest-snapshot/build/inline_snapshots.js"],replacements:[{from:"_callee$property$loc$.column",to:"0",optional:!0},{from:"const {line, column} = callee.property.loc.start;",to:"const {line } = callee.property.loc.start; const column = 0;",optional:!0},{from:"const snapshotsByFile = groupSnapshotsByFile(snapshots);",to:"global.$_$tracer._remapInlineSnapshots(snapshots); const snapshotsByFile = groupSnapshotsByFile(snapshots);"}]},{files:["ts-jest/dist/compiler.js"],replacements:[{from:"getScriptVersion: function (fileName) {",to:'getScriptVersion: function (fileName) { fileName = require("path").normalize(fileName);'},{from:"getScriptSnapshot: function (fileName) {",to:'getScriptSnapshot: function (fileName) { fileName = require("path").normalize(fileName);'}]},{files:["jest-util/build/setGlobal.js"],replacements:[{from:"globalToMutate[key] = value;",to:"globalToMutate[key] = value;\n             if (globalToMutate.$_$wp) return;\n             if (!globalToMutate.regeneratorRuntime && global.regeneratorRuntime) {\n              globalToMutate.regeneratorRuntime = global.regeneratorRuntime;\n             }\n             globalToMutate.$_$wp = global.$_$wp;\n             globalToMutate.$_$wpe = global.$_$wpe;\n             globalToMutate.$_$w = global.$_$w;\n             globalToMutate.$_$w_ = global.$_$w_;\n             globalToMutate.$_$wf = global.$_$wf;\n             globalToMutate.$_$wv = global.$_$wv;\n             globalToMutate.$_$tracer = global.$_$tracer;\n             global.$_$tracer.setEnvGlobal(globalToMutate);\n             globalToMutate.$_$tracer._jasmineAdapter = new global.$_$tracer.JasmineReporter(global.$_$tracer);\n        "}]}],"Possibly incompatible/unsupported Jest version");var JasmineReporter=function(e){var t=global.$_$session,n=e.initialSpecId(),r=[],i=function(){return t!==global.$_$session};this.jasmineDone=function(){i()||(global.$_$initialSpecId=n+1)},this.jasmineStarted=function(){i()||e.started({total:"unknown number of"})},this.suiteStarted=function(e){i()||r.push(e.description)},this.suiteDone=function(){i()||r.pop()},this.specStarted=function(t){i()||(t._id=++n,e.specStart(t._id,t.fullName),t._time=(new e._Date).getTime())},this.specDone=function(t){if(!i()){var n=e.specEnd(),o="disabled"===t.status||"pending"===t.status||"todo"===t.status,s={id:t._id,timeRange:n,name:t.description,suite:r.slice(),success:"passed"===t.status,skipped:o,time:o?0:(new e._Date).getTime()-t._time,log:[],testFile:t._testFile};if(!s.success&&!s.skipped)for(var a=t.failedExpectations,l=0;l<a.length;l++){var c=a[l];if(c.error){if(c.message&&0===c.message.indexOf("Error: expect(")){var u=c.message.split("\n");u.shift(),u[0]&&0!==u[0].length||u.shift(),c.message=u.join("\n")}c.error.matcherResult?(c.matcherName=c.error.matcherResult.name,c.actual=c.error.matcherResult.actual,c.expected=c.error.matcherResult.expected):(c.showDiff=c.error.showDiff,c.actual=c.error.actual,c.expected=c.error.expected)}c.showDiff=c.showDiff||"toEqual"===c.matcherName||"toBe"===c.matcherName||"toMatchSnapshot"===c.matcherName||"toMatchInlineSnapshot"===c.matcherName,s.log.push(e.setAssertionData(c,{message:c.message,stack:c.stack}))}s.log.length||delete s.log,e.result(s)}}};tracer.JasmineReporter=JasmineReporter;var WallabyRunner=function(){function e(e){this._sessionId=e,this._runComplete=!1}return e.prototype.onRunStart=function(){},e.prototype.onTestStart=function(){},e.prototype.isActive=function(){return this._sessionId===global.$_$session},e.prototype.getLastError=function(){return this._error},e.prototype._setError=function(e){this._error=e},e.prototype.completeRun=function(e){!this._runComplete&&this.isActive()&&(this._runComplete=!0,tracer.resetEnvGlobal(),tracer.complete(e))},e.prototype.onTestResult=function(e,t){t.testExecError&&this.isActive()&&("Your test suite must contain at least one test."===t.testExecError.message&&(t.testExecError.stack="Error: Your test suite must contain at least one test.\n    at "+t.testFilePath+":1:0",t.testExecError.allowNotMappedStackLines=!0),tracer.reportGlobalErrorObject(__assign({},t.testExecError)),this.completeRun())},e.prototype.onRunComplete=function(e,t){!tracer.canUpdateSnapshots()&&t&&t.testResults&&t.testResults.forEach&&t.testResults.forEach(function(e){if(e&&e.snapshot&&e.snapshot.unchecked){var t=e.snapshot.unchecked+" snapshot"+(e.snapshot.unchecked>1?"s":"")+" obsolete "+(e.snapshot.uncheckedKeys&&"\n\t"+e.snapshot.uncheckedKeys.join("\n\t")||"");tracer.reportGlobalErrorObject({message:t,stack:t+"\n    at "+e.testFilePath+":1:0",snapshot:!0,allowNotMappedStackLines:!0})}}),this.completeRun()},e}(),initializeJest=function(){return __awaiter(_this,void 0,void 0,function(){var e,t,n,r,i,o,s,a,l;return __generator(this,function(c){switch(c.label){case 0:return[4,utils.loadJest(localProjectRoot,global.wallaby._testFrameworkPath,global.wallaby._testConfigFile)];case 1:if(e=c.sent()||{},t=e.jestCLI,n=e.jestConfigLoader,jestConfig=e.jestConfig,!t)throw new Error("Can not find jest-cli module");if(!jestConfig)throw new Error("Can not load jest config");if(!n)throw new Error("Can not find jest-config module");if(jestRuntime=utils.tryRequireModuleWithPathFrom(n.path,"jest-runtime",1),!jestRuntime)throw new Error("Can not find Jest runtime module");if(r=utils.tryRequireModuleWithPathFrom(t.path,"@jest/core"),!r)throw new Error("Can not find Jest core module");if(JestTestScheduler=r.module.TestScheduler,!JestTestScheduler)throw new Error("Can not find Jest test scheduler module");return i=utils.tryRequireModuleWithPathFrom(t.path,"@jest/reporters"),i?(o=function(e,t){var n=e.prototype;n.log=n._write=t?function(){}:function(e){console.log("Jest: "+e+"\n")}},o(i.module.BaseReporter),o(i.module.DefaultReporter),o(i.module.SummaryReporter,!0)):console.warn("Can not find Jest reporters module"),jestRunGlobalHook=utils.tryRequireModuleWithPathFrom(t.path,"@jest/core/build/runGlobalHook"),jestRunGlobalHook||console.warn("Can not find Jest run global hook module"),s=utils.tryRequireModuleWithPathFrom(t.path,"@jest/console"),s?tracer._reportConsoleErrorAsError&&(a=function(e){var t=e.prototype,n=t.error;t.error=function(){return tracer._error.apply(tracer,arguments),n.apply(this,arguments)}},a(s.module.BufferedConsole),a(s.module.CustomConsole)):console.warn("Can not find Jest console module"),jestConfig.configs=(jestConfig.configs||[]).filter(function(e){return"jest-runner"===e.runner||~utils.normalizePath(e.runner||"").indexOf("node_modules/jest-runner/")||"jest-runner-groups"===e.runner||~utils.normalizePath(e.runner||"").indexOf("node_modules/jest-runner-groups/")}),jestConfig.configs.forEach(function(e){if(e.bail=0,e.notify=0,e.collectCoverage=!1,e.collectCoverageFrom=e.collectCoverageFrom||(jestConfig.globalConfig||{}).collectCoverageFrom,e.collectCoverageFrom&&e.collectCoverageFrom.length||(e.collectCoverageFrom=["**/*.{"+e.moduleFileExtensions.join(",")+"}"]),e.coveragePathIgnorePatterns=e.coveragePathIgnorePatterns&&e.coveragePathIgnorePatterns.map(function(e){return new RegExp(e)}),e.errorOnDeprecated=!1,e.setupFilesAfterEnv=e.setupFilesAfterEnv||[],e.transformIgnorePatterns=e.transformIgnorePatterns||[],e.testRunner=e.testRunner.replace("jest-circus/runner","jest-jasmine2/build/index").replace("jest-circus\\runner","jest-jasmine2\\build\\index"),e.setupFilesAfterEnv.unshift(jasmineInitializerPath),e.transformIgnorePatterns.push(utils.replacePathSepForRegex(path.join(path.basename(path.dirname(jasmineInitializerPath)),path.basename(jasmineInitializerPath)))),e.verbose=null,delete e.watchPlugins,e.globals=e.globals||{},e.globals["ts-jest"]=e.globals["ts-jest"]||{},e.globals["ts-jest"].diagnostics!==!0&&(e.globals["ts-jest"].diagnostics=!1),e.resolver){var t=path.join("node_modules","@nrwl","jest","plugins","resolver.js");if(e.resolver.endsWith(t)){var n=path.dirname(path.dirname(path.dirname(path.dirname(path.dirname(e.resolver))))),r=path.join(n,"angular.json"),i=path.join(n,"workspace.json"),o=fs.existsSync(r)?r:fs.existsSync(i)?i:void 0;if(o&&fs.statSync(o)){var s=path.relative(n,e.rootDir).replace(/\\/,"/");try{var a=JSON.parse(fs.readFileSync(o).toString()),l=Object.keys(a.projects).map(function(e){return __assign({},a.projects[e])}).filter(function(e){return e.root===s}).filter(function(e){return e.architect&&e.architect.test&&"@nrwl/jest:jest"===e.architect.test.builder}).map(function(e){return e.architect.test.options});if(1===l.length){var c=l[0].tsConfig,u=l[0].setupFile;c&&(e.globals["ts-jest"].tsConfig="<rootDir>/"+path.relative(s,c)),u&&e.setupFilesAfterEnv.push(path.resolve(n,u)),e.globals["ts-jest"].stringifyContentPathRegex="\\.html$",o===r&&(utils.tryRequireModuleWithPathFrom(localProjectRoot,"jest-preset-angular/InlineHtmlStripStylesTransformer")?e.globals["ts-jest"].astTransformers=["jest-preset-angular/InlineHtmlStripStylesTransformer"]:utils.tryRequireModuleWithPathFrom(localProjectRoot,"jest-preset-angular/build/InlineFilesTransformer")&&(e.globals["ts-jest"].astTransformers=["jest-preset-angular/build/InlineFilesTransformer","jest-preset-angular/build/StripStylesTransformer"]))}}catch(h){}}}}}),l=jestConfig.globalConfig,l.notify=!1,l.bail=0,l.collectCoverage=!1,l.detectLeaks=!1,l.detectOpenHandles=!1,l.errorOnDeprecated=!1,l.json=!1,l.maxWorkers=1,l.useStderr=!1,l.watch=!1,l.verbose=null,process.env.NO_WATCHMAN&&(l.watchman=!1),delete l.findRelatedTests,delete l.listTests,delete l.forceExit,delete l.onlyChanged,delete l.onlyFailures,delete l.outputFile,delete l.passWithNoTests,delete l.watchAll,delete l.watchPlugins,[2]}})})},testRunner,testFiles,testContexts,testFilesByPath,noopTestWatcher={setState:function(){},isInterrupted:function(){return!1},isWatchMode:function(){return!1}},configure=function(e){return __awaiter(_this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return t=global.$_$session,testRunner?[2,testRunner]:[4,initializeJest()];case 1:return n.sent(),e&&jestConfig.configs.forEach(function(t){Object.keys(e).forEach(function(n){t[n]=e[n]})}),[4,Promise.all(jestConfig.configs.map(function(e){return jestRuntime.module.createContext(e,{maxWorkers:jestConfig.globalConfig.maxWorkers,watchman:jestConfig.globalConfig.watchman})}))];case 2:return testContexts=n.sent(),t!==global.$_$session?[2]:(testRunner=new JestTestScheduler(jestConfig.globalConfig),[2,testRunner])}})})},getTestData=function(e){return e.map(function(e){return{path:e,context:testContexts.length>1?testContexts.reduce(function(t,n){e&&(e=e.normalize());var r=e.replace((n.config.rootDir||"").normalize(),"").length;return t?t.relativePathLength>r?{context:n,relativePathLength:r}:t:{context:n,relativePathLength:r}},void 0).context:testContexts[0]}})};tracer.start(function(){return __awaiter(_this,void 0,void 0,function(){var e,t,n,r,i;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,9,,10]),testFilesByPath=void 0,e=new WallabyRunner(global.$_$session),[4,configure()];case 1:if(t=o.sent(),!t||!e.isActive())return[2];t.removeReporter(WallabyRunner),t.addReporter(e),o.label=2;case 2:return o.trys.push([2,6,7,8]),n=getTestData(testFiles),jestConfig.globalConfig.updateSnapshot=tracer.canUpdateSnapshots()?"all":process.env.CI?"none":"new",[4,jestRunGlobalHook.module({allTests:n,globalConfig:jestConfig.globalConfig,moduleName:"globalSetup"})];case 3:return o.sent(),e.isActive()?[4,t.scheduleTests(n,noopTestWatcher)]:[2];case 4:return o.sent(),e.isActive()?[4,jestRunGlobalHook.module({allTests:n,globalConfig:jestConfig.globalConfig,moduleName:"globalTeardown"})]:[2];case 5:return o.sent(),[3,8];case 6:return r=o.sent(),r&&console.error(r.stack),[3,8];case 7:return e.completeRun(),[7];case 8:return[3,10];case 9:return i=o.sent(),tracer.reportGlobalError("Failed to initialize wallaby jest.\n"+(i&&i.message||"")),[3,10];case 10:return[2]}})})});var getFileData=function(e){var t=global.wallaby.localProjectDir,n=global.wallaby.projectCacheDir,r=utils.normalizePath(e.replace(t,"").replace(n,""));return"/"===r[0]&&(r=r.substr(1)),tracer._filePathToFileData[r]},initializeTestsByFilePath=function(){testFilesByPath||(testFilesByPath={},global.$_$testFiles.forEach(function(e){testFilesByPath[e.path]=e}))};tracer._fileCacheKey=function(e){var t=getFileData(e);if(t){var n=t.path+"_"+workerId+"_"+t.id+"_"+t.ts;if(t.childFilePath){var r=getFileData(t.childFilePath);r&&(n+="_"+r.id+"_"+r.ts)}return n}},tracer._fileId=function(e){var t=getFileData(e);if(t)return t.id},tracer._remapInlineSnapshots=function(e){initializeTestsByFilePath(),e.forEach(function(e){if(e.frame){var t=testFilesByPath[path.normalize(e.frame.file)];t&&t.lineMap&&(e.frame.line=utils.getOriginalLineByGeneratedLine(t.lineMap,e.frame.line,e.frame.column)||e.frame.line,e.frame.column=1)}})};var readFileSync=fs.readFileSync;fs.readFileSync=function(e){var t=getFileData(e);return t&&t.inOriginalFilesCache&&(arguments[0]=path.join(originalCacheRoot,t.path)),readFileSync.apply(this,arguments)},tracer._extendJestTransformer=function(e,t){var n=getFileData(e);if(!n||!n.instrument)return t;var r=function(e,t,n){return!!e.test||!(n.coveragePathIgnorePatterns||[]).some(function(e){return utils.pathMatchesPattern(t,e,{absolute:!0})})&&(".node"!==path.extname(t)&&".json"!==path.extname(t)&&!n.collectCoverageFrom.some(function(t){return"!"===t[0]&&!utils.pathMatchesPattern(e.path,t,{micromatch:!0})})&&n.collectCoverageFrom.some(function(t){return"!"!==t[0]&&utils.pathMatchesPattern(e.path,t,{micromatch:!0})}))},i=function(e){var t=e.getCacheKey||function(e,t){return t};e.getCacheKey=function(n,r,i,o){var s=t.call(e,n,r,i,o),a=getFileData(r);if(a&&(s+="_"+a.id+"_"+workerId+"_"+a.ts,a.childFilePath)){var l=getFileData(a.childFilePath);l&&(s+="_"+l.id+"_"+l.ts)}return s};var n=e.process;return e.process=function(t,i,o,s){var a=n.call(e,t,i,o,s),l=!0;a&&null===a.code&&(a.code=t,l=!1);var c;a&&a.scriptSrc&&(c=getFileData(i),c&&(i=path.join(i,"..",a.scriptSrc)),delete a.scriptSrc);var u=getFileData(i);if(u&&r(u,i,o)){var h=u.id;"string"==typeof a?a={code:a,map:utils.getSourceMapFromCode(a)}:l&&"string"==typeof a.code&&!a.map&&(a.map=utils.getSourceMapFromCode(a.code)),"string"==typeof a.map&&(a.map=JSON.parse(a.map));var d=a.code,p=_.extend({},global.$_$tracer._hints);u.test&&(p.allowIgnoringCoverageInTests||(p=_.omit(p,"ignoreCoverage","ignoreCoverageForFile"))),p=_.omit(p,"testFileSelection");var f=a.map&&(u.changeStart||u.transientChange)&&new utils.SourceMapConsumer(a.map),g=utils.mapTextPosition(u.changeStart&&u.changePosition,f),m=void 0;try{m=utils.instrument(d,{file:h,test:u.test,fileName:path.basename(u.path),testFileChangeStart:g,hints:p,recordValues:global.$_$tracer._autoConsoleLog,preserveComments:global.$_$tracer._preserveComments,virtualLog:u.transientChange&&u.transientChange.range?{changeId:u.transientChange.id,traceId:u.transientChange.traceId,expanded:u.transientChange.expanded,range:utils.mapOriginalRangeToTransformed(f,u.transientChange.range)}:void 0})}catch(v){throw utils.formatInstrumentationError(v,d,u.path)}if(tracer.sendTransformedFile({id:h,parentFilePath:c&&c.path,transformed:_.omit(a,"code"),instrumented:_.omit(m,"code","map"),lineMap:utils.updateFileMap({},a.map?[a.map,m.map]:[m.map]),ts:u.ts}),m.numberOfFunctions!==u.numberOfFunctions&&delete m.testName,u.test&&(!global.$_$traceContext||!global.$_$traceContext.test))if(m.testName){"*"===global.$_$tests&&(global.$_$tests={});var y=global.$_$tests[":?"]=global.$_$tests[":?"]||{};y[":"+m.testName]="*"}else global.$_$tests&&global.$_$tests[":?"]&&(global.$_$tests="*");var b=utils.docBlockComment(a.code).replace(/\r?\n|\r/g," ");b&&(m.code=b+m.code),a.code=m.code,delete a.map;for(var T=global.$_$coverage[h]=[],k=0;k<m.ranges.length;k++)T[k]={}}return a},e._wallabyExtended=!0,e};return t?t&&!t._wallabyExtended?i(t):t:i({getCacheKey:function(e,t,n,r){return t},process:function(e,t,n,r){return{code:null,map:null}}})},module.exports={init:function(e){return testFiles=e,{configure:function(e){testRunner||configure(e)["catch"](function(e){return console.error("Error while trying to configure jest: "+(e&&e.message||""))})}}}};